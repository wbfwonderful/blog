[{"title":"Hello World ğŸ‘‹","url":"/blog/hello-world/","content":"ğŸ˜æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ä½ ä¹Ÿè®¸å¯ä»¥çœ‹åˆ°ï¼š\n\nâœï¸å­¦ä¹ è®°å½•\nğŸ’»æŠ€æœ¯åˆ†äº«\nğŸ“‘æ—¥å¸¸æµæ°´è´¦\nâ€¦\n\n"},{"title":"ã€Kaggle Coursesã€‘3-æœºå™¨å­¦ä¹ ä»‹ç»","url":"/blog/Kaggle-course/intro-to-ML/","content":"Learn the core ideas in machine learning, and build your first models. Click here for more information.\n\n\næ¨¡å‹æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ\nThe first step.\n\nå¼•å…¥è€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼š\n\nä½ è¡¨å¼Ÿåšæˆ¿åœ°äº§æŠ•æœºèµšäº†å‡ ç™¾ä¸‡ç¾å…ƒã€‚å› ä¸ºä½ å¯¹æ•°æ®ç§‘å­¦æ„Ÿå…´è¶£ï¼Œä»–æå‡ºè¦å’Œä½ æˆä¸ºå•†ä¸šä¼™ä¼´ã€‚ä»–ä¼šæä¾›é’±ï¼Œä½ ä¼šæä¾›æ¨¡å‹æ¥é¢„æµ‹å„ç§æˆ¿å­çš„ä»·å€¼ã€‚\nä½ é—®ä½ çš„å ‚å…„ä»–è¿‡å»æ˜¯å¦‚ä½•é¢„æµ‹æˆ¿åœ°äº§ä»·å€¼çš„ï¼Œä»–è¯´è¿™åªæ˜¯ç›´è§‰ã€‚ä½†æ›´å¤šçš„è´¨ç–‘è¡¨æ˜ï¼Œä»–ä»è¿‡å»çœ‹è¿‡çš„æˆ¿å­ä¸­è¯†åˆ«å‡ºäº†ä»·æ ¼æ¨¡å¼ï¼Œå¹¶ç”¨è¿™äº›æ¨¡å¼æ¥é¢„æµ‹ä»–æ­£åœ¨è€ƒè™‘çš„æ–°æˆ¿ã€‚\nâ€¦\n\nè€ƒè™‘è¿™ä¸ªç®€å•çš„å†³ç­–æ ‘ï¼šå®ƒåªæŠŠæˆ¿å­åˆ†æˆä¸¤ç±»ã€‚æ‰€è€ƒè™‘çš„ä»»ä½•æˆ¿å±‹çš„é¢„æµ‹ä»·æ ¼éƒ½æ˜¯åŒä¸€ç±»åˆ«æˆ¿å±‹çš„å†å²å¹³å‡ä»·æ ¼ã€‚\né€šè¿‡æ•°æ®æ¥å†³å®šå¦‚ä½•å°†æˆ¿å±‹åˆ†ä¸ºä¸¤ç±»ï¼ŒåŒæ—¶å†³å®šå…¶é¢„æµ‹ä»·æ ¼ã€‚ä»æ•°æ®ä¸­æ•è·æ¨¡å¼çš„è¿™ä¸€æ­¥ç§°ä¸ºæ‹Ÿåˆ(fitting)æˆ–è®­ç»ƒ(training)æ¨¡å‹ã€‚ç”¨äºæ‹Ÿåˆæ¨¡å‹çš„æ•°æ®ç§°ä¸ºè®­ç»ƒæ•°æ®(training data)ã€‚\næ”¹è¿›å†³ç­–æ ‘ä»¥ä¸‹å“ªä¸ªå†³ç­–æ ‘æ›´æœ‰æ•ˆï¼Ÿå·¦è¾¹çš„å†³ç­–æ ‘ï¼ˆå†³ç­–æ ‘1ï¼‰å¯èƒ½æ›´æœ‰æ„ä¹‰ï¼Œå› ä¸ºå®ƒæŠ“ä½äº†ä¸€ä¸ªç°å®ï¼Œå³å§å®¤å¤šçš„æˆ¿å­å¾€å¾€æ¯”å§å®¤å°‘çš„æˆ¿å­å–å¾—æ›´é«˜ã€‚è¿™ç§æ¨¡å¼æœ€å¤§çš„ç¼ºç‚¹æ˜¯ï¼Œå®ƒæ²¡æœ‰è€ƒè™‘åˆ°å½±å“æˆ¿ä»·çš„å¤§å¤šæ•°å› ç´ ï¼Œæ¯”å¦‚æµ´å®¤æ•°é‡ã€åœ°å—å¤§å°ã€ä½ç½®ç­‰ã€‚\nå¯ä»¥ä½¿ç”¨å…·æœ‰æ›´å¤šâ€œåˆ†è£‚â€çš„æ ‘æ¥æ•è·æ›´å¤šå› ç´ ã€‚è¿™äº›æ ‘è¢«ç§°ä¸ºâ€œæ›´æ·±çš„â€æ ‘ã€‚è€ƒè™‘åˆ°æ¯æ ‹æˆ¿å­åœ°å—æ€»é¢ç§¯çš„å†³ç­–æ ‘å¯èƒ½æ˜¯è¿™æ ·çš„ï¼šæˆ¿å­çš„é¢„æµ‹ä»·æ ¼åœ¨è¿™æ£µæ ‘çš„åº•éƒ¨ã€‚æˆ‘ä»¬åšå‡ºé¢„æµ‹çš„åº•éƒ¨ç‚¹è¢«ç§°ä¸ºå¶å­ (leaf)ã€‚\nåˆæ­¥æ¢ç´¢æ•°æ®\nLoad and understand your data.\n\nä½¿ç”¨ Pandas æ¥åŠ è½½æ•°æ®Pandas æ˜¯æ•°æ®ç§‘å­¦å®¶ç”¨æ¥æ¢ç´¢å’Œæ“ä½œæ•°æ®çš„ä¸»è¦å·¥å…·ã€‚å¤§å¤šæ•°äººåœ¨ä»£ç ä¸­å°† pandas ç¼©å†™ä¸º pdï¼š\nimport pandas as pd\nPandas åº“ä¸­æœ€é‡è¦çš„éƒ¨åˆ†æ˜¯ DataFrameã€‚DataFrame ä¿å­˜äº†æ‚¨å¯èƒ½è®¤ä¸ºæ˜¯è¡¨çš„æ•°æ®ç±»å‹ã€‚è¿™ç±»ä¼¼äº Excel ä¸­çš„å·¥ä½œè¡¨æˆ– SQL æ•°æ®åº“ä¸­çš„è¡¨ã€‚\nä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ¥è¯»å– csv æ–‡ä»¶ï¼Œå¹¶è¿›è¡Œå±•ç¤ºï¼š\ndf = pd.read_csv(&#x27;my_csv.csv&#x27;)df.describe()\næ›´å¤šå…³äº pandas çš„ä»‹ç»ã€‚\nå¯¹æ•°æ®çš„è§£é‡ŠæŸä¸ª csv æ–‡ä»¶é€šè¿‡ .describe() å±•ç¤ºçš„ç»“æœä¸ºï¼š\n\nç»“æœä¸ºåŸå§‹æ•°æ®é›†ä¸­çš„æ¯åˆ—æ˜¾ç¤º8ä¸ªæ•°å­—ã€‚ç¬¬ä¸€ä¸ªæ•°å­—æ˜¯ countï¼Œæ˜¾ç¤ºæœ‰å¤šå°‘è¡Œå…·æœ‰éç¼ºå¤±å€¼ã€‚\nç¼ºå¤±å€¼çš„äº§ç”Ÿæœ‰å¾ˆå¤šåŸå› ã€‚ä¾‹å¦‚ï¼Œåœ¨è°ƒæŸ¥ä¸€é—´å§å®¤çš„æˆ¿å­æ—¶ï¼Œä¸ä¼šæ”¶é›†ç¬¬äºŒé—´å§å®¤çš„å¤§å°ã€‚æˆ‘ä»¬å°†å›åˆ°ä¸¢å¤±æ•°æ®çš„è¯é¢˜ã€‚\n\n\nç¬¬äºŒä¸ªå€¼æ˜¯å‡å€¼ï¼Œä¹Ÿå°±æ˜¯å¹³å‡å€¼ã€‚åœ¨æ­¤ä¹‹ä¸‹ï¼Œstd æ˜¯æ ‡å‡†åå·®ï¼Œå®ƒè¡¡é‡æ•°å€¼çš„æ•°å€¼åˆ†å¸ƒã€‚\nåç»­äº”ä¸ªå€¼ï¼šå°†è¯¥åˆ—çš„æ•°æ®å‡åºæ’åºå½¢æˆä¸€ä¸ªåˆ—è¡¨ï¼Œåœ¨åˆ—è¡¨ä¸­èµ°å››åˆ†ä¹‹ä¸€ï¼Œä¼šå‘ç°ä¸€ä¸ªå¤§äº 25% ä¸”å°äº 75% çš„å€¼ã€‚è¿™æ˜¯ 25% çš„å®šä¹‰ã€‚\n\nç¬¬ä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹\nBuilding your first model. Hurray!\n\né€‰æ‹©å»ºæ¨¡çš„æ•°æ®ä¸€æ¡æ•°æ®æœ‰å¾ˆå¤šå˜é‡ï¼Œå¦‚ä½•é€‰æ‹©åˆé€‚çš„å˜é‡ï¼Ÿæˆ‘ä»¬å…ˆç”¨ç›´è§‰é€‰å‡ ä¸ªå˜é‡ã€‚åé¢çš„è¯¾ç¨‹å°†å±•ç¤ºè‡ªåŠ¨ç¡®å®šå˜é‡ä¼˜å…ˆçº§çš„ç»Ÿè®¡æŠ€æœ¯ã€‚\né¦–å…ˆéœ€è¦æŸ¥çœ‹æ•°æ®é›†ä¸­æ‰€æœ‰åˆ—çš„åˆ—è¡¨ã€‚é€šè¿‡ DataFrame çš„ columns å±æ€§å®Œæˆï¼š\nimport pandas as pdmelbourne_file_path = &#x27;../input/melbourne-housing-snapshot/melb_data.csv&#x27;melbourne_data = pd.read_csv(melbourne_file_path) print(melbourne_data.columns)\nIndex([&#x27;Suburb&#x27;, &#x27;Address&#x27;, &#x27;Rooms&#x27;, &#x27;Type&#x27;, &#x27;Price&#x27;, &#x27;Method&#x27;, &#x27;SellerG&#x27;,       &#x27;Date&#x27;, &#x27;Distance&#x27;, &#x27;Postcode&#x27;, &#x27;Bedroom2&#x27;, &#x27;Bathroom&#x27;, &#x27;Car&#x27;,       &#x27;Landsize&#x27;, &#x27;BuildingArea&#x27;, &#x27;YearBuilt&#x27;, &#x27;CouncilArea&#x27;, &#x27;Lattitude&#x27;,       &#x27;Longtitude&#x27;, &#x27;Regionname&#x27;, &#x27;Propertycount&#x27;],      dtype=&#x27;object&#x27;)\næŸäº›æ•°æ®å¯èƒ½æœ‰ç¼ºå¤±å€¼ï¼Œåç»­è¯¾ç¨‹ä¼šè§£å†³ç¼ºå¤±å€¼ã€‚è¿™é‡Œç®€å•åœ°åˆ é™¤æœ‰ç¼ºå¤±çš„æ•°æ®ï¼Œé€šè¿‡ .dropna()ï¼š\nmelbourne_data = melbourne_data.dropna(axis=0)\næ³¨æ„ .dropna() ä¸ä¼šåœ¨å½“å‰ DataFrame ä¸Šè¿›è¡Œä¿®æ”¹ï¼Œè€Œæ˜¯ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œæ‰€ä»¥éœ€è¦èµ‹å€¼ç»™æ–°å¯¹è±¡ã€‚\nè·å– DataFrame å­é›†çš„æ–¹æ³•ï¼š\n\nä½¿ç”¨ç‚¹ .\nä½¿ç”¨ä¸€ä¸ªåˆ—ååˆ—è¡¨\n\né€‰æ‹©é¢„æµ‹ç›®æ ‡é€šè¿‡ç‚¹ . æ¥è®¿é—®æŸä¸ªå˜é‡çš„æ•°æ®ã€‚è¿™äº›æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ª Series ä¸­ï¼Œå®ƒå¤§è‡´ç±»ä¼¼äºåªæœ‰å•åˆ—æ•°æ®çš„ DataFrame ã€‚éœ€è¦é¢„æµ‹çš„å˜é‡ä¸º Price ï¼Œå®šä¹‰ä¸ºyï¼š\ny = melbourne_data.Price\n\né€‰æ‹©ç‰¹å¾â€œç‰¹å¾â€å®šä¹‰ä¸ºè¾“å…¥æ¨¡å‹çš„æ•°æ®åˆ—ï¼Œå¹¶åç»­ç”¨äºé¢„æµ‹ã€‚ä½¿ç”¨åˆ—ååˆ—è¡¨æ¥è·å–ï¼Œå¹¶å®šä¹‰ä¸º xï¼š\nmelbourne_features = [&#x27;Rooms&#x27;, &#x27;Bathroom&#x27;, &#x27;Landsize&#x27;, &#x27;Lattitude&#x27; &#x27;Longtitude&#x27;]x = melbourne_data[melbourne_features]\nä½¿ç”¨ .head() æ–¹æ³•æŸ¥çœ‹å¤´éƒ¨å‡ ä¸ªæ ·æœ¬ï¼š\nx.head()\n\næ„å»ºæ¨¡å‹ä½¿ç”¨ scikit-learn åŒ…æ¥åˆ›å»ºæ¨¡å‹ã€‚ä»£ç ä¸­å†™ä½œ sklearnã€‚\né€šè¿‡ä»¥ä¸‹æ­¥éª¤æ¥æ„å»ºæ¨¡å‹ï¼š\n\nå®šä¹‰ï¼šæ¨¡å‹ç±»å‹ã€æ¨¡å‹å‚æ•°\næ‹Ÿåˆï¼ˆè®­ç»ƒï¼‰ï¼šä»æ•°æ®ä¸­å­¦ä¹ æ¨¡å¼\né¢„æµ‹ï¼šJust what it sounds likeï¼ˆåŸæ–‡ğŸ¤”ï¼‰\nè¯„ä¼°ï¼šç¡®å®šæ¨¡å‹çš„å‡†ç¡®åº¦\n\nä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š\nfrom sklearn.tree import DecisionTreeRegressor# Define model. Specify a number for random_state to ensure same results each runmelbourne_model = DecisionTreeRegressor(random_state=1)# Fit modelmelbourne_model.fit(X, y)\n\nè®¾ç½® random_state ç¡®ä¿åœ¨æ¯ä¸€ä¸ªè½®æ¬¡ä¸­è·å–ç›¸åŒçš„ç»“æœã€‚ä½†æ˜¯æ¨¡å‹çš„æ€§èƒ½å’Œè¿™ä¸ªæ•°å­—æ— å…³ã€‚\nç°åœ¨ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹æ¥é¢„æµ‹è¾“å…¥çš„å‰ 5 ä¸ªæ•°æ®ï¼š\nmelbourne_model.predict(X.head())\næ¨¡å‹éªŒè¯\nMeasure the performance of your model, so you can test and compare alternatives.\n\nä»€ä¹ˆæ˜¯æ¨¡å‹éªŒè¯è®¸å¤šäººåœ¨è¡¡é‡é¢„æµ‹å‡†ç¡®æ€§æ—¶çŠ¯äº†ä¸€ä¸ªå·¨å¤§çš„é”™è¯¯ã€‚ä»–ä»¬ç”¨è®­ç»ƒæ•°æ®è¿›è¡Œé¢„æµ‹ï¼Œå¹¶å°†è¿™äº›é¢„æµ‹ä¸è®­ç»ƒæ•°æ®ä¸­çš„ç›®æ ‡å€¼è¿›è¡Œæ¯”è¾ƒã€‚ç¨åæ‚¨å°†çœ‹åˆ°è¿™ç§æ–¹æ³•çš„é—®é¢˜ä»¥åŠå¦‚ä½•è§£å†³å®ƒï¼Œä½†è®©æˆ‘ä»¬å…ˆè€ƒè™‘ä¸€ä¸‹å¦‚ä½•åšè¿™ä¸ªã€‚\nè€ƒè™‘æœ€ç®€å•çš„å¹³å‡ç»å¯¹è¯¯å·®ï¼ˆMean Absolute Error, MAEï¼‰ï¼š\nerror = actual - predicted\n\nä½¿ç”¨ scikit-learn è®¡ç®— MAEï¼š\nfrom sklearn.metrics import mean_absolute_errorpredicted_home_prices = melbourne_model.predict(X)mean_absolute_error(y, predicted_home_prices)\n\nâ€œIn-Sampleâ€åˆ†æ•°çš„é—®é¢˜å‰é¢æåˆ°çš„è¯„ä»·æ–¹å¼æ˜¯ä¸€ç§â€œæ ·æœ¬å†…â€åˆ†æ•°ï¼ˆin-sampleï¼‰ã€‚æ˜¯åŒç»Ÿä¸€æ•°æ®æ¥è®­ç»ƒå’Œé¢„æµ‹ã€‚æƒ³è±¡ä»¥ä¸‹åœºæ™¯ï¼š\n\nåœ¨å¤§å‹æˆ¿åœ°äº§å¸‚åœºä¸­ï¼Œé—¨çš„é¢œè‰²ä¸æˆ¿ä»·æ— å…³ã€‚ç„¶è€Œï¼Œåœ¨æ‚¨ç”¨äºæ„å»ºæ¨¡å‹çš„æ•°æ®æ ·æœ¬ä¸­ï¼Œæ‰€æœ‰å¸¦æœ‰ç»¿è‰²é—¨çš„æˆ¿å±‹éƒ½éå¸¸æ˜‚è´µã€‚è¿™ä¸ªæ¨¡å‹çš„å·¥ä½œæ˜¯æ‰¾åˆ°é¢„æµ‹æˆ¿ä»·çš„æ¨¡å¼ï¼Œæ‰€ä»¥å®ƒä¼šçœ‹åˆ°è¿™ä¸ªæ¨¡å¼ï¼Œå®ƒæ€»æ˜¯ä¼šé¢„æµ‹ç»¿è‰²é—¨çš„æˆ¿å±‹çš„é«˜ä»·æ ¼ã€‚ç”±äºè¯¥æ¨¡å¼æ˜¯ä»è®­ç»ƒæ•°æ®ä¸­å¯¼å‡ºçš„ï¼Œå› æ­¤è¯¥æ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸­ä¼šæ˜¾å¾—å‡†ç¡®ã€‚ä½†æ˜¯ï¼Œå¦‚æœå½“æ¨¡å‹çœ‹åˆ°æ–°çš„æ•°æ®æ—¶ï¼Œè¿™ç§æ¨¡å¼ä¸æˆç«‹ï¼Œé‚£ä¹ˆåœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œæ¨¡å‹å°†éå¸¸ä¸å‡†ç¡®ã€‚\n\nç”±äºæ¨¡å‹çš„å®ç”¨ä»·å€¼æ¥è‡ªäºå¯¹æ–°æ•°æ®çš„é¢„æµ‹ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æœªç”¨äºæ„å»ºæ¨¡å‹çš„æ•°æ®ä¸Šè¡¡é‡æ€§èƒ½ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæœ€ç›´æ¥çš„æ–¹æ³•æ˜¯ä»æ¨¡å‹æ„å»ºè¿‡ç¨‹ä¸­æ’é™¤ä¸€äº›æ•°æ®ï¼Œç„¶åä½¿ç”¨è¿™äº›æ•°æ®æ¥æµ‹è¯•æ¨¡å‹å¯¹ä»¥å‰æ²¡æœ‰è§è¿‡çš„æ•°æ®çš„å‡†ç¡®æ€§ã€‚è¿™äº›æ•°æ®ç§°ä¸ºéªŒè¯æ•°æ®ï¼ˆvalidation dataï¼‰ã€‚\nCoding it!scikit-learn æä¾›äº† train_test_solit æ–¹æ³•æ¥åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚\nfrom sklearn.model_selection import train_test_split# split data into training and validation data, for both features and target# The split is based on a random number generator. Supplying a numeric value to# the random_state argument guarantees we get the same split every time we# run this script.train_X, val_X, train_y, val_y = train_test_split(X, y, random_state = 0, test_size=0.2)# Define modelmelbourne_model = DecisionTreeRegressor()# Fit modelmelbourne_model.fit(train_X, train_y)# get predicted prices on validation dataval_predictions = melbourne_model.predict(val_X)print(mean_absolute_error(val_y, val_predictions))\n\né€šè¿‡è®¾ç½® test_size æ¥æ›´æ”¹æµ‹è¯•é›†çš„æ¯”ä¾‹ã€‚\nWow!ç»è¿‡æµ‹è¯•ï¼Œæ ·æœ¬å†…æ•°æ®çš„å¹³å‡ç»å¯¹è¯¯å·®çº¦ä¸º500ç¾å…ƒï¼Œè€Œæ ·æœ¬å¤–è¶…è¿‡25ä¸‡ç¾å…ƒï¼\næ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆ\nFine-tune your model for better performance.\n\nå®éªŒä¸åŒæ¨¡å‹ä¸¤ä¸ªæç«¯\n\nå½“æˆ‘ä»¬æŠŠæˆ¿å­åˆ†æˆè®¸å¤šç‰‡å¶å­æ—¶ï¼Œæ¯ç‰‡å¶å­ä¸Šçš„æˆ¿å­ä¹Ÿæ›´å°‘ã€‚æˆ¿å­å¾ˆå°‘çš„æ ‘å¶ä¼šåšå‡ºéå¸¸æ¥è¿‘è¿™äº›æˆ¿å­çš„å®é™…ä»·å€¼çš„é¢„æµ‹ï¼Œä½†å®ƒä»¬å¯¹æ–°æ•°æ®çš„é¢„æµ‹å¯èƒ½éå¸¸ä¸å¯é ï¼ˆå› ä¸ºæ¯æ¬¡é¢„æµ‹éƒ½åªåŸºäºå‡ æ‰€æˆ¿å­ï¼‰ã€‚\nè¿™æ˜¯ä¸€ç§è¢«ç§°ä¸ºè¿‡æ‹Ÿåˆçš„ç°è±¡ï¼Œå³æ¨¡å‹å‡ ä¹å®Œç¾åœ°åŒ¹é…è®­ç»ƒæ•°æ®ï¼Œä½†åœ¨éªŒè¯å’Œå…¶ä»–æ–°æ•°æ®æ–¹é¢è¡¨ç°ä¸ä½³ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæˆ‘ä»¬æŠŠæ ‘ç”»å¾—å¾ˆæµ…ï¼Œå®ƒå°±ä¸ä¼šæŠŠæˆ¿å­åˆ†æˆå¾ˆæ˜æ˜¾çš„ç»„ã€‚\n\n\nå¦‚æœä¸€æ£µæ ‘åªæŠŠæˆ¿å­åˆ†æˆ2ä¸ªæˆ–4ä¸ªï¼Œæ¯ä¸€ç»„ä»ç„¶æœ‰å„ç§å„æ ·çš„æˆ¿å­ã€‚å¯¹å¤§å¤šæ•°æœºæ„æ¥è¯´ï¼Œç»“æœé¢„æµ‹å¯èƒ½è¿˜å¾ˆé¥è¿œï¼Œç”šè‡³åœ¨è®­ç»ƒæ•°æ®ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ï¼ˆå‡ºäºåŒæ ·çš„åŸå› ï¼Œå®ƒåœ¨éªŒè¯ä¸­ä¹Ÿä¼šå¾ˆç³Ÿç³•ï¼‰ã€‚\nå½“ä¸€ä¸ªæ¨¡å‹æ— æ³•æ•æ‰æ•°æ®ä¸­çš„é‡è¦åŒºåˆ«å’Œæ¨¡å¼ï¼Œå› æ­¤å³ä½¿åœ¨è®­ç»ƒæ•°æ®ä¸­ä¹Ÿè¡¨ç°ä¸ä½³ï¼Œè¿™è¢«ç§°ä¸ºæ¬ æ‹Ÿåˆã€‚\n\n\n\nä¾‹å­é€šè¿‡è®¾ç½®ä¸åŒæ•°é‡çš„å†³ç­–æ ‘ç»“ç‚¹æ•°é‡ max_leaf_nodesï¼Œè®¡ç®—å‡ºä¸åŒçš„ç²¾ç¡®ç‡ã€‚\nfrom sklearn.metrics import mean_absolute_errorfrom sklearn.tree import DecisionTreeRegressordef get_mae(max_leaf_nodes, train_X, val_X, train_y, val_y):    model = DecisionTreeRegressor(max_leaf_nodes=max_leaf_nodes, random_state=0)    model.fit(train_X, train_y)    preds_val = model.predict(val_X)    mae = mean_absolute_error(val_y, preds_val)    return(mae)\n\nç»“è®ºä¸¤ç§æƒ…å†µï¼š\n\nè¿‡æ‹Ÿåˆï¼šæ•æ‰æœªæ¥ä¸ä¼šå†å‡ºç°çš„è™šå‡æ¨¡å¼ï¼Œå¯¼è‡´é¢„æµ‹ä¸é‚£ä¹ˆå‡†ç¡®\næ¬ æ‹Ÿåˆï¼šæ— æ³•æ•æ‰ç›¸å…³çš„æ¨¡å¼ï¼ŒåŒæ ·å¯¼è‡´é¢„æµ‹ä¸å‡†ç¡®\n\néšæœºæ£®æ—\nUsing a more sophisticated machine learning algorithm.\n\nå¼•å…¥å†³ç­–æ ‘ç•™ç»™ä½ ä¸€ä¸ªè‰°éš¾çš„å†³å®šã€‚æœ‰å¾ˆå¤šå¶å­çš„æ·±æ ‘ä¼šè¿‡æ‹Ÿåˆï¼Œå› ä¸ºæ¯ä¸ªé¢„æµ‹éƒ½æ˜¯æ¥è‡ªå¶å­é™„è¿‘çš„å°‘æ•°æˆ¿å±‹çš„å†å²æ•°æ®ã€‚ä½†æ˜¯ä¸€æ£µå¶å­å¾ˆå°‘çš„æµ…æ ‘ä¼šè¡¨ç°å¾—å¾ˆå·®ï¼Œå› ä¸ºå®ƒæ— æ³•åœ¨åŸå§‹æ•°æ®ä¸­æ•æ‰åˆ°å°½å¯èƒ½å¤šçš„åŒºåˆ«ã€‚\nå³ä½¿æ˜¯ä»Šå¤©æœ€å¤æ‚çš„å»ºæ¨¡æŠ€æœ¯ä¹Ÿé¢ä¸´ç€æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆä¹‹é—´çš„ç´§å¼ å…³ç³»ã€‚ä½†æ˜¯ï¼Œè®¸å¤šæ¨¡å‹éƒ½æœ‰èªæ˜çš„æƒ³æ³•ï¼Œå¯ä»¥å¸¦æ¥æ›´å¥½çš„æ€§èƒ½ã€‚æˆ‘ä»¬å°†ä»¥éšæœºæ£®æ—ä¸ºä¾‹ã€‚\néšæœºæ£®æ—ä½¿ç”¨è®¸å¤šæ ‘ï¼Œå®ƒé€šè¿‡å¹³å‡æ¯ä¸ªç»„æˆæ ‘çš„é¢„æµ‹æ¥è¿›è¡Œé¢„æµ‹ã€‚å®ƒé€šå¸¸æ¯”å•ä¸€å†³ç­–æ ‘å…·æœ‰æ›´å¥½çš„é¢„æµ‹å‡†ç¡®æ€§ï¼Œå¹¶ä¸”åœ¨é»˜è®¤å‚æ•°ä¸‹å·¥ä½œå¾—å¾ˆå¥½ã€‚\nfrom sklearn.ensemble import RandomForestRegressorfrom sklearn.metrics import mean_absolute_errorforest_model = RandomForestRegressor(random_state=1)forest_model.fit(train_X, train_y)melb_preds = forest_model.predict(val_X)print(mean_absolute_error(val_y, melb_preds))\nç»“è®ºå¯èƒ½è¿˜æœ‰è¿›ä¸€æ­¥æ”¹è¿›çš„ç©ºé—´ï¼Œä½†è¿™å·²ç»æ¯”25ä¸‡çš„æœ€ä½³å†³ç­–æ ‘è¯¯å·®æœ‰äº†å¾ˆå¤§çš„æ”¹è¿›ã€‚æœ‰ä¸€äº›å‚æ•°å…è®¸ä½ æ”¹å˜éšæœºæ£®æ—çš„æ€§èƒ½ï¼Œå°±åƒæˆ‘ä»¬æ”¹å˜å•ä¸ªå†³ç­–æ ‘çš„æœ€å¤§æ·±åº¦ä¸€æ ·ã€‚ä½†éšæœºæ£®æ—æ¨¡å‹çš„ä¸€ä¸ªæœ€ä½³ç‰¹å¾æ˜¯ï¼Œå³ä½¿æ²¡æœ‰è¿™ç§è°ƒæ•´ï¼Œå®ƒä»¬é€šå¸¸ä¹Ÿèƒ½åˆç†åœ°å·¥ä½œã€‚\næœºå™¨å­¦ä¹ æ¯”èµ›\nEnter the world of machine learning competitions to keep improving and see your progress.\n\nItâ€™s your turn!\n","categories":["Kaggle courses"],"tags":["Kaggle","Pandas","Python"]},{"title":"ã€Kaggle Coursesã€‘1-ç¼–ç¨‹ä»‹ç»","url":"/blog/Kaggle-course/intro-to-programming/","content":"Get started with Python, if you have no coding experience. Click here for more information.\n\n\nè®¡ç®—å’Œå˜é‡\nMake calculations, and define and modify variables.\n\næ‰“å°æ‰“å°ä¸€æ¡æ¶ˆæ¯ã€‚\nprint(&#x27;hello&#x27;)\nè®¡ç®—æ‰“å°è®¡ç®—ç»“æœã€‚\nprint(1 + 2)\næ³¨é‡Šä½¿ç”¨ # å†™æ³¨é‡Šã€‚\nå‡½æ•°\nOrganize your code and avoid redundancy.\n\nä¸€ä¸ªç®€å•çš„ä¾‹å­def add_three(input_var):    output_var = input_var + 3    return output_var\nå‡½æ•°åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†: header å’Œ body.\n\nHeader: å®šä¹‰å‡½æ•°åå’Œå‚æ•°ã€‚\nBody: å®šä¹‰å‡½æ•°å¦‚ä½•å·¥ä½œã€‚\n\nå˜é‡ä½œç”¨åŸŸå‡½æ•°å†…éƒ¨å®šä¹‰çš„å˜é‡æ— æ³•åœ¨å‡½æ•°å¤–è®¿é—®ã€‚\næ•°æ®ç±»å‹\nExplore integers, floats, booleans, and strings.\n\nint, float, boolean, string\næ¡ä»¶å’Œæ¡ä»¶å£°æ˜\nModify how functions run, depending on the input.if, if-else, if-elif-else\n\nåˆ—è¡¨ä»‹ç»\nOrganize your data so you can work with it efficiently.\n\nç´¢å¼•\nè·å–æœ€åä¸€ä¸ªå…ƒç´ : [-1]\nè·å–å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ : [-2]\n\nåˆ‡ç‰‡åˆ‡ç‰‡ï¼šè·å–åˆ—è¡¨çš„ä¸€ä¸ªç‰‡æ®µã€‚\n\nè·å–å‰ x ä¸ªå…ƒç´ ï¼š[:x]\nè·å–å y ä¸ªå…ƒç´ ï¼š[-y:]\n\næ­¤å¤„â€œå…ƒç´ â€çš„è‹±æ–‡ä¸ºâ€œentryâ€ã€‚\nl = [1, 2, 3, 4, 5]print(l[:2])print(l[-2:])\n[1, 2][4, 5]\nåˆ é™¤ä½¿ç”¨ .remove()\næ·»åŠ ä½¿ç”¨ .add()\n","categories":["Kaggle courses"],"tags":["Kaggle","Python"]},{"title":"ã€Kaggle Coursesã€‘4-pandas","url":"/blog/Kaggle-course/pandas-kaggle/","content":"Solve short hands-on challenges to perfect your data manipulation skills. Click here for more information.\n\nåˆ›å»ºã€è¯»å’Œå†™\nYou canâ€™t work with data if you canâ€™t read it. Get started here.\n\nå¼€å§‹å¯¼å…¥ pandasï¼š\nimport pandas as pd\nåˆ›å»ºæ•°æ®Pandas ä¸­çš„ä¸¤ä¸ªæ ¸å¿ƒå¯¹è±¡ï¼šDataFrame å’Œ Seriesã€‚\nDataFrameDataFrame æ˜¯ä¸€ä¸ªè¡¨ã€‚å®ƒåŒ…å«ä¸€ä¸ªå•ç‹¬æ¡ç›®ï¼ˆentryï¼‰çš„æ•°ç»„ï¼Œæ¯ä¸ªæ¡ç›®éƒ½æœ‰ä¸€ä¸ªç‰¹å®šçš„å€¼ã€‚æ¯ä¸ªæ¡ç›®å¯¹åº”ä¸€è¡Œï¼ˆæˆ–è®°å½•ï¼‰å’Œä¸€åˆ—ã€‚ä¾‹å¦‚ï¼š\npd.DataFrame(&#123;&#x27;Yes&#x27;: [50, 21], &#x27;No&#x27;: [131, 2]&#125;)\nåœ¨æœ¬ä¾‹ä¸­ï¼Œâ€œ0ï¼ŒNoâ€ æ¡ç›®çš„å€¼ä¸º 131 ã€‚â€œ0ï¼ŒYesâ€ æ¡ç›®çš„å€¼ä¸º 50ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ•°æ®æ¡†æ¡ç›®ä¸é™äºæ•´æ•°ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå€¼ä¸ºå­—ç¬¦ä¸²çš„DataFrameï¼š\npd.DataFrame(&#123;&#x27;Bob&#x27;: [&#x27;I liked it.&#x27;, &#x27;It was awful.&#x27;], &#x27;Sue&#x27;: [&#x27;Pretty good.&#x27;, &#x27;Bland.&#x27;]&#125;)\n\næˆ‘ä»¬ä½¿ç”¨ pd.DataFrame() æ„é€ å‡½æ•°æ¥ç”Ÿæˆè¿™äº› DataFrame å¯¹è±¡ã€‚å£°æ˜ä¸€ä¸ªæ–°å¯¹è±¡çš„è¯­æ³•æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå®ƒçš„é”®æ˜¯åˆ—åï¼ˆæœ¬ä¾‹ä¸­æ˜¯Bobå’ŒSueï¼‰ï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ªæ¡ç›®åˆ—è¡¨ã€‚è¿™æ˜¯æ„é€ æ–° DataFrame çš„æ ‡å‡†æ–¹æ³•ã€‚\nå­—å…¸åˆ—è¡¨æ„é€ å‡½æ•°å°†å€¼èµ‹ç»™åˆ—æ ‡ç­¾ï¼Œä½†å¯¹è¡Œæ ‡ç­¾æ¥è¯´ï¼Œé»˜è®¤æ˜¯ä» 0 å¼€å§‹çš„å‡åºè®¡æ•°ã€‚\nDataFrame ä¸­ä½¿ç”¨çš„è¡Œæ ‡ç­¾åˆ—è¡¨ç§°ä¸ºç´¢å¼•ã€‚å¯ä»¥é€šè¿‡åœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨ index å½¢å‚ç»™å®ƒèµ‹å€¼ï¼š\npd.DataFrame(&#123;&#x27;Bob&#x27;: [&#x27;I liked it.&#x27;, &#x27;It was awful.&#x27;],               &#x27;Sue&#x27;: [&#x27;Pretty good.&#x27;, &#x27;Bland.&#x27;]&#125;,             index=[&#x27;Product A&#x27;, &#x27;Product B&#x27;])\n\nSeriesç›¸æ¯”ä¹‹ä¸‹ï¼Œåºåˆ—æ˜¯æ•°æ®å€¼çš„åºåˆ—ã€‚å¦‚æœ DataFrame æ˜¯ä¸€ä¸ªè¡¨ï¼Œé‚£ä¹ˆ Series å°±æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚åªéœ€è¦ä¸€ä¸ªåˆ—è¡¨å°±å¯ä»¥åˆ›å»ºä¸€ä¸ª Series å¯¹è±¡ï¼š\npd.Series([1, 2, 3, 4, 5])\n\nä»æœ¬è´¨ä¸Šè®²ï¼ŒSeries æ˜¯ DataFrame çš„ä¸€åˆ—ã€‚å› æ­¤ï¼Œå¯ä»¥åƒä»¥å‰ä¸€æ ·ä½¿ç”¨ index å‚æ•°å°†è¡Œæ ‡ç­¾åˆ†é…ç»™ Seriesã€‚ä½†æ˜¯ï¼Œ Series æ²¡æœ‰åˆ—åï¼Œå®ƒåªæœ‰ä¸€ä¸ªæ€»ç§°ï¼š\npd.Series([30, 35, 40], index=[&#x27;2015 Sales&#x27;, &#x27;2016 Sales&#x27;, &#x27;2017 Sales&#x27;], name=&#x27;Product A&#x27;)\n\nè¯»å–æ•°æ®æ•°æ®å¯ä»¥ä»¥è®¸å¤šä¸åŒçš„å½¢å¼å’Œæ ¼å¼ä¸­çš„ä»»ä½•ä¸€ç§è¿›è¡Œå­˜å‚¨ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå…¶ä¸­æœ€åŸºæœ¬çš„æ˜¯ CSV æ–‡ä»¶ã€‚å½“ä½ æ‰“å¼€ä¸€ä¸ª CSV æ–‡ä»¶æ—¶ï¼Œä½ ä¼šçœ‹åˆ°è¿™æ ·çš„ä¸œè¥¿ï¼š\nProduct A,Product B,Product C,30,21,9,35,34,1,41,11,11\nCSV æ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç”¨é€—å·åˆ†éš”çš„å€¼è¡¨ã€‚å› æ­¤å¾—åï¼šComma-Separated Valuesï¼ŒCSVã€‚\nè¯»å–å¹¶æŸ¥çœ‹ CSV æ–‡ä»¶ï¼š\nimport pandas as pddf = pd.read_csv(&#x27;file.csv&#x27;)df.shapedf.head()\n\nç´¢å¼•ã€é€‰æ‹©å’Œèµ‹å€¼\nPro data scientists do this dozens of times a day. You can, too!\n\nåŸç”Ÿè®¿é—®å™¨åŸç”Ÿ Python å¯¹è±¡æä¾›äº†ç´¢å¼•æ•°æ®çš„æ–¹æ³•ã€‚PandasåŒ…å«äº†æ‰€æœ‰è¿™äº›å†…å®¹ï¼š\ndf = pd.read_csv(&#x27;file.csv&#x27;)# è®¿é—® country åˆ—ï¼ˆè®¿é—®ä¸€ä¸ª Series ï¼‰df.countrydf[&#x27;country&#x27;]# è®¿é—®è¯¥åˆ—çš„æŸä¸ªå¯¹è±¡df[&#x27;country&#x27;][0]\nPandas ä¸­çš„ç´¢å¼•Pandas æœ‰è‡ªå·±çš„ç´¢å¼•æ–¹å¼ loc ã€‚Pandas ç´¢å¼•çš„å·¥ä½œæ–¹å¼æœ‰ä¸¤ç§ã€‚\nåŸºäºç´¢å¼•çš„é€‰æ‹©iloc åŸºäºæ•°å€¼ä½ç½®é€‰æ‹©æ•°æ®ã€‚ä¾‹å¦‚è®¿é—®ç¬¬ä¸€è¡Œçš„æ•°æ®ï¼š\ndf.iloc[0]\n\nloc å’Œ iloc éƒ½æ˜¯è¡Œä¼˜å…ˆï¼Œè¿™æ„å‘³ç€æ£€ç´¢è¡Œç¨å¾®å®¹æ˜“ä¸€äº›ï¼Œè€Œè·å–æ£€ç´¢åˆ—ç¨å¾®å›°éš¾ä¸€äº›ã€‚ä¾‹å¦‚è®¿é—®ç¬¬ä¸€åˆ—çš„æ•°æ®ï¼š\ndf.iloc[:, 0]\n\næ›´å¤šä¾‹å­ï¼š\n# è®¿é—®ç¬¬äºŒè¡Œå’Œç¬¬ä¸‰è¡Œçš„ç¬¬ä¸€åˆ—df.iloc[1 : 3, 0]# ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨df.iloc[[1, 2], 0]\n\nåŸºäºæ ‡ç­¾çš„é€‰æ‹©iloc åœ¨æ¦‚å¿µä¸Šæ¯” loc ç®€å•ï¼Œå› ä¸ºå®ƒå¿½ç•¥æ•°æ®é›†çš„ç´¢å¼•ã€‚å½“ä½¿ç”¨ iloc æ—¶ï¼Œæˆ‘ä»¬å°†æ•°æ®é›†è§†ä¸ºä¸€ä¸ªå¤§çŸ©é˜µï¼ˆåˆ—è¡¨çš„åˆ—è¡¨ï¼‰ï¼Œæˆ‘ä»¬å¿…é¡»æ ¹æ®ä½ç½®å¯¹å…¶è¿›è¡Œç´¢å¼•ã€‚\nç›¸æ¯”ä¹‹ä¸‹ï¼Œloc ä½¿ç”¨ç´¢å¼•ä¸­çš„ä¿¡æ¯æ¥å®Œæˆå·¥ä½œã€‚ç”±äºæ•°æ®é›†é€šå¸¸åŒ…å«æœ‰æ„ä¹‰çš„ç´¢å¼•ï¼Œå› æ­¤ä½¿ç”¨locé€šå¸¸æ›´å®¹æ˜“ã€‚ä¾‹å¦‚ï¼Œè®¿é—®æ‰€æœ‰è¡Œçš„ä»¥ä¸‹å±æ€§ï¼š\ndf.loc[:, [&#x27;taster_name&#x27;, &#x27;taster_twitter_handle&#x27;, &#x27;points&#x27;]]\n\nloc è¿˜æ˜¯ iloc ï¼Ÿ\niloc ä½¿ç”¨æ ‡å‡†çš„ç´¢å¼•ç­–ç•¥ï¼Œ0:10 çš„ç»“æœæ˜¯ 0,...,9ï¼Œè€Œ loc çš„ç»“æœæ˜¯ 0,...,10ã€‚\nloc å¯ä»¥è¿™æ ·ç”¨ï¼šdf.loc[&#39;a&#39;:&#39;d&#39;] ï¼Œè¡¨ç¤ºç´¢å¼•æ ‡ç­¾ a åˆ° d ä¹‹é—´çš„æ‰€æœ‰åˆ—ã€‚ï¼ˆåŒ…æ‹¬ dï¼‰\niloc ç´¢å¼•æ•°å€¼ä½ç½®ï¼Œloc ç´¢å¼•æ ‡ç­¾ï¼Œä¸” loc åŒ…æ‹¬â€œç»“å°¾â€ã€‚\n\næ“ä½œç´¢å¼•Pandas é»˜è®¤ä½¿ç”¨æ•°å­—ä½œä¸ºç´¢å¼•ï¼Œå¯ä»¥é€šè¿‡ set_index() å°†æŒ‡å®šåˆ—è®¾ç½®ä¸ºç´¢å¼•ï¼š\ndf = df.set_index(&quot;title&quot;)\n\næ³¨æ„ï¼Œé‡æ–°è®¾ç½®ç´¢å¼•ä¹‹åè¦è¿›è¡Œèµ‹å€¼ã€‚å³ä¸ä¼šåœ¨åŸæ¥çš„åŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹ï¼Œè€Œæ˜¯ä¼šè¿”å›ä¸€ä¸ªæ–°çš„ DataFrame å¯¹è±¡ã€‚\næ¡ä»¶é€‰æ‹©ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬å¯¹æ„å¤§åˆ©ç”Ÿäº§çš„å¥½äºå¹³å‡æ°´å¹³çš„è‘¡è„é…’ç‰¹åˆ«æ„Ÿå…´è¶£ã€‚\næˆ‘ä»¬é¦–å…ˆéœ€è¦æ£€æŸ¥æ¯ä¸€ç“¶é…’æ˜¯å¦æ¥è‡ªæ„å¤§åˆ©ï¼š\ndf.country == &#x27;Italy&#x27;\n\nè¿™ä¸ªæ“ä½œä¼šè¿”å›ä¸€ä¸ªå…¨æ˜¯å¸ƒå°”å˜é‡çš„ Series å¯¹è±¡ã€‚è¡¨ç¤ºè¯¥è¡Œçš„ country å±æ€§æ˜¯å¦ä¸º Italy ã€‚\næ¥ä¸‹æ¥å¯ä»¥é€šè¿‡ loc æ¥é€‰æ‹©å¯¹åº”çš„è¡Œï¼š\ndf.loc[df.country == &#x27;Italy&#x27;]\nå¯ä»¥ä½¿ç”¨ &amp; æˆ–è€… | æ¥æºå¸¦å¤šä¸ªæ¡ä»¶ï¼š\ndf.loc[(df.country == &#x27;Italy&#x27;) &amp; (reviews.points &gt;= 90)]\n\næ­¤å¤–ï¼Œpandas è¿˜æä¾›äº†ä¸€äº›å†…ç½®çš„é€‰æ‹©å™¨ï¼šisin() å’Œ isnull()\nisin() é€‰æ‹©é‚£äº›å€¼åœ¨ç»™å®šåˆ—è¡¨é‡Œçš„æ•°æ®ã€‚ä¾‹å¦‚é€‰å–åŒ…å«æ„å¤§åˆ©å’Œæ³•å›½çš„è¡Œï¼š\ndf.loc[df.country.isin([&#x27;Italy&#x27;, &#x27;France&#x27;])]# ç­‰ä»·äºdf.loc[(df.country == &#x27;Italy&#x27;) | (df.country == &#x27;France&#x27;)]\n\nisnull() é€‰æ‹©é‚£äº›åŒ…å«ç©ºå€¼çš„è¡Œï¼š\ndf.loc[df.price.isnull()]\nèµ‹å€¼ç»™ä¸€æ•´åˆ—èµ‹å€¼ï¼š\n# å°†æ•´åˆ—éƒ½èµ‹å€¼ä¸º everyonereviews[&#x27;critic&#x27;] = &#x27;everyone&#x27;# ä¹Ÿå¯ä»¥ä½¿ç”¨å¯è¿­ä»£çš„å¯¹è±¡ï¼ˆlistã€rangeç­‰ï¼‰reviews[&#x27;index_backwards&#x27;] = range(len(reviews), 0, -1)\n\næ€»ç»“å‡½æ•°å’Œæ˜ å°„\nExtract insights from your data.\n\næ€»ç»“å‡½æ•°ä½¿ç”¨ describe() æ–¹æ³•è·å–å¯¹æ•°æ®çš„é«˜çº§æè¿°ï¼š\nå¯¹ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œä¼šæœ‰ä¸åŒçš„æ€»ç»“ï¼Œä¾‹å¦‚å¯¹å­—ç¬¦ä¸²ï¼š\nmean() æ–¹æ³•ï¼šæŸ¥çœ‹æŸä¸€åˆ—çš„å¹³å‡å€¼ã€‚\nunique() æ–¹æ³•ï¼šæŸ¥çœ‹æŸä¸€åˆ—çš„å”¯ä¸€å€¼åˆ—è¡¨ã€‚ï¼ˆå¯¹åº”äº describe è¾“å‡ºçš„ unique å…³é”®å­—ï¼‰\ncount() æ–¹æ³•ï¼šæŸ¥çœ‹æŸä¸€åˆ—çš„å”¯ä¸€å€¼åˆ—è¡¨ä»¥åŠå…¶å‡ºç°æ¬¡æ•°ã€‚\næ˜ å°„ï¼ˆMapsï¼‰æ‰¹é‡ä¿®æ”¹æŸäº›åˆ—ã€‚\nä¾‹å¦‚ï¼Œæƒ³è¦å°†æŸä¸€åˆ—å‡å»å…¶å‡å€¼ï¼š\nreview_points_mean = reviews.points.mean()reviews.points.map(lambda p: p - review_points_mean)\nä¼ é€’ç»™ map() çš„å‡½æ•°åº”è¯¥æœŸæœ›å¾—åˆ°æ¥è‡ª Series çš„å•ä¸ªå€¼ï¼ˆåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­æ˜¯ä¸€ä¸ªç‚¹å€¼ï¼Œå³ pï¼‰ï¼Œå¹¶è¿”å›è¯¥å€¼çš„è½¬æ¢ç‰ˆæœ¬ï¼ˆå³ p - review_points_meanï¼‰ã€‚mapï¼ˆï¼‰è¿”å›ä¸€ä¸ªæ–°çš„ Series ï¼Œå…¶ä¸­æ‰€æœ‰çš„å€¼éƒ½å·²è¢«å‡½æ•°è½¬æ¢è¿‡ã€‚\nè¿™é‡Œ lambda è¡¨ç¤ºåŒ¿åå‡½æ•°ï¼Œå…¶ç­‰ä»·äºä»¥ä¸‹å‡½æ•°ï¼š\ndef my_function(p):    return p - review_points_mean\n\nåŒæ ·åœ°ï¼Œ apply() æ–¹æ³•åŒæ ·å¯ä»¥å®ç°ä¸Šè¿°è¿‡ç¨‹ï¼š\ndef remean_points(row):    row.points = row.points - review_points_mean    return rowreviews.apply(remean_points, axis=&#x27;columns&#x27;)\n\næ­¤å¤–ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨æ“ä½œç¬¦ + ã€ - ç­‰ç›´æ¥å¯¹ Series å¯¹è±¡è¿›è¡Œæ“ä½œï¼Œè¿™æ¯”ä¸Šè¿°ä¸¤ä¸ªå‡½æ•°æ›´é«˜æ•ˆï¼Œä½†æ˜¯ä¸æ”¯æŒæ›´å¤æ‚çš„æƒ…å†µã€‚\nåˆ†ç»„å’Œæ’åº\nScale up your level of insight. The more complex the dataset, the more this matters\n\nåˆ†ç»„åˆ†æä»¥ä¸‹ä»£ç ç­‰åŒäº value_counts() æ–¹æ³•ï¼š\nreviews.groupby(&#x27;points&#x27;).points.count()\n\nå³æŒ‰ç…§ points åˆ—è¿›è¡Œåˆ†ç»„ï¼Œåˆ†ç»„ä¹‹åå†å¯¹ point åˆ—è¿›è¡Œè®¡æ•°ã€‚\nreviews.groupby(&#x27;points&#x27;).price.min()\nä¸Šè¿°ä»£ç æŒ‰ç…§ points åˆ—è¿›è¡Œåˆ†ç»„ï¼Œåˆ†ç»„ä¹‹åï¼Œåœ¨æ¯ä¸ªç»„é‡Œé¢è®¡ç®—æœ€å°å€¼ã€‚\nç”Ÿæˆçš„æ¯ä¸ªç»„å¯ä»¥è§†ä¸º DataFrame çš„ä¸€ä¸ªç‰‡æ®µï¼Œå…¶ä¸­ä»…åŒ…å«å…·æœ‰åŒ¹é…å€¼çš„æ•°æ®ã€‚å¯ä»¥ç›´æ¥ä½¿ç”¨ apply() æ–¹æ³•è®¿é—®è¿™ä¸ª DataFrameï¼Œç„¶åå¯ä»¥é€šè¿‡ä»»ä½•æ–¹å¼æ“ä½œæ•°æ®ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯ä»æ•°æ®é›†ä¸­çš„æ¯ä¸ªé…’å‚ä¸­é€‰æ‹©ç¬¬ä¸€ä¸ªè¢«è¯„è®ºçš„è‘¡è„é…’åç§°çš„ä¸€ç§æ–¹æ³•ï¼š\nreviews.groupby(&#x27;winery&#x27;).apply(lambda df: df.title.iloc[0])\n\nå¯¹äºæ›´ç»†ç²’åº¦çš„ï¼Œè¿˜å¯ä»¥æŒ‰å¤šä¸ªåˆ—åˆ†ç»„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä»¥ä¸‹æ˜¯æˆ‘ä»¬å¦‚ä½•æŒ‰å›½å®¶å’Œçœä»½æŒ‘é€‰æœ€å¥½çš„è‘¡è„é…’ï¼š\nreviews.groupby([&#x27;country&#x27;, &#x27;province&#x27;]).apply(lambda df: df.loc[df.points.idxmax()])\n\næ’åºç®€å•æ’åºï¼ˆé»˜è®¤å‡åºï¼‰ï¼š\ncountries_reviewed.sort_values(by=&#x27;len&#x27;)\n\næŒ‰ç…§å¤šä¸ªåˆ—è¿›è¡Œæ’åºï¼š\ncountries_reviewed.sort_values(by=[&#x27;country&#x27;, &#x27;len&#x27;])\n\næ•°æ®ç±»å‹å’Œç¼ºå¤±å€¼\nDeal with the most common progress-blocking problems\n\næ•°æ®ç±»å‹DataFrame æˆ–Series ä¸­æ¯åˆ—çš„æ•°æ®ç±»å‹ç§°ä¸º dtype ã€‚å¯ä»¥ä½¿ç”¨ dtype å±æ€§è·å–ç‰¹å®šåˆ—çš„ç±»å‹ã€‚\nreviews.price.dtype\n\ndtypes å±æ€§è¿”å› DataFrame ä¸­æ¯ä¸€åˆ—çš„æ•°æ®ç±»å‹ã€‚\nreviews.dtypes\n\næ³¨æ„ï¼Œå­—ç¬¦ä¸²çš„ç±»å‹ä¸º object ã€‚\nå¯ä»¥ä½¿ç”¨ astype() æ–¹æ³•è¿›è¡Œæ•°æ®è½¬æ¢ï¼š\nreviews.points.astype(&#x27;float64&#x27;)\n\nç¼ºå¤±å€¼ä½¿ç”¨ fillna() æ–¹æ³•æ¥æ›¿æ¢ç¼ºå¤±å€¼ã€‚é€šå¸¸å¯ä»¥è®¾ç½®ä¸ºâ€œunkonwnâ€å­—ç¬¦ä¸²ï¼Œä¾¿äºåç»­æ›´æ”¹ã€‚è¿™ç§å€¼é€šå¸¸è¢«ç§°ä½œâ€œå“¨å…µâ€ï¼Œè¿˜åŒ…æ‹¬â€œUndisclosedâ€ã€â€œInvalidâ€ç­‰ã€‚\næ­¤å¤–å¯ä»¥ä½¿ç”¨ replace() æ–¹æ³•æ¥æ›¿æ¢è®¾ç½®çš„å“¨å…µå€¼ã€‚\né‡å‘½åå’Œç»„åˆ\nData comes in from many sources. Help it all make sense together\n\né‡å‘½åæœ‰æ—¶éœ€è¦æ›´æ”¹åˆ—æ˜æˆ–ç´¢å¼•åã€‚\n# å°† points åˆ—æ›´åä¸º scorereviews.rename(columns=&#123;&#x27;points&#x27;: &#x27;score&#x27;&#125;)# å°†ç¬¬ä¸€è¡Œå’Œç¬¬äºŒè¡Œæ›´åä¸º firstEntry å’Œ secondEntryreviews.rename(index=&#123;0: &#x27;firstEntry&#x27;, 1: &#x27;secondEntry&#x27;&#125;)\n\nç»„åˆç»„åˆæ¥è‡ªå¤šä¸ª DataFrame æˆ– Series çš„æ•°æ®ã€‚\nä¾‹å¦‚ï¼Œä¸¤ä¸ª CSV æ–‡ä»¶æœ‰ç›¸åŒçš„åˆ—ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯ conca() ã€‚\ncanadian_youtube = pd.read_csv(&quot;../input/youtube-new/CAvideos.csv&quot;)british_youtube = pd.read_csv(&quot;../input/youtube-new/GBvideos.csv&quot;)pd.concat([canadian_youtube, british_youtube])\n\nä¾‹å¦‚ï¼Œç»„åˆä¸¤ä¸ªå…·æœ‰ç›¸åŒç´¢å¼•çš„ CSV æ–‡ä»¶ï¼š\nleft = canadian_youtube.set_index([&#x27;title&#x27;, &#x27;trending_date&#x27;])right = british_youtube.set_index([&#x27;title&#x27;, &#x27;trending_date&#x27;])left.join(right, lsuffix=&#x27;_CAN&#x27;, rsuffix=&#x27;_UK&#x27;)\nlsuffix å’Œ rsuffix å‚æ•°ç”¨äºåŒºåˆ†ä¸¤ä¸ªç›¸åŒçš„åˆ—ã€‚\nç®€å•è¯»å†™ CSV æ–‡ä»¶è¯»import pandas as pddf = pd.read_csv(&#x27;./file.csv&#x27;)\nå†™for i, row in df.iterrows():    path = row[&#x27;path&#x27;]    label = row[&#x27;label&#x27;]\næ–°å»ºdata = &#123;    &#x27;path&#x27;: [&#x27;path1&#x27;, &#x27;path2&#x27;],    &#x27;label&#x27;: [&#x27;label1&#x27;, &#x27;label2&#x27;]&#125;    new_df = pd.DateFrame(data)new_df.to_csv(&#x27;./new_file.csv&#x27;, index=False)\nloc æ–¹æ³•å®šä½æŸä¸€è¡Œpath = df.loc[index][&#x27;path&#x27;]\n\nå®šä½æŸåˆ—çš„æŒ‡å®šå€¼df = df.loc[df[&#x27;label&#x27;] == &#x27;Normal&#x27;]df = df.reset_index()","categories":["Kaggle courses"],"tags":["Kaggle","Pandas","Python"]},{"title":"ã€Kaggle Coursesã€‘2-python","url":"/blog/Kaggle-course/python-kaggle/","content":"coming soonâ€¦\n","tags":["Kaggle","Python"]},{"title":"ã€LLMã€‘nanoGPTå­¦ä¹ ","url":"/blog/LLM/nanogpt/","content":"å†™åœ¨å‰é¢æœ¬æ–‡ä¸»è¦è®°å½• nanoGPT çš„å­¦ä¹ è¿‡ç¨‹ï¼Œå‚è€ƒé“¾æ¥\n\nGPT in 60 Lines of NumPyï¼šhttps://jaykmody.com/blog/gpt-from-scratch/60 è¡Œä»£ç å®ç° gptï¼ˆä¸Šä¸€ç¯‡çš„ç¿»è¯‘ï¼‰ï¼š https://zhuanlan.zhihu.com/p/679330102nanoGPT å®æˆ˜ï¼š https://zhuanlan.zhihu.com/p/716442447nanoGPT ä»£ç è§£è¯»ï¼šhttps://zhuanlan.zhihu.com/p/677407971\n\nGPT åŸç†\nGPT(Generative Pre-trained Transformer)åŸºäºTransformerè§£ç å™¨è‡ªå›å½’åœ°é¢„æµ‹ä¸‹ä¸€ä¸ªTokenï¼Œä»è€Œè¿›è¡Œäº†è¯­è¨€æ¨¡å‹çš„å»ºæ¨¡ã€‚GPTçš„ä¼ªä»£ç å¯ä»¥ç®€å•çš„è¡¨ç¤ºä¸ºï¼š\n\ndef gpt(inputs: list[int]) -&gt; list[list[float]]:\t&quot;&quot;&quot; GPTä»£ç ï¼Œå®ç°é¢„æµ‹ä¸‹ä¸€ä¸ªtoken\tinputsï¼šList[int], shapeä¸º[n_seq]ï¼Œè¾“å…¥æ–‡æœ¬åºåˆ—çš„token idçš„åˆ—è¡¨\toutputï¼šList[List[int]], shapeä¸º[n_seq, n_vocab]ï¼Œé¢„æµ‹è¾“å‡ºçš„logitsåˆ—è¡¨\t&quot;&quot;&quot;    output = # éœ€è¦å®ç°çš„GPTå†…éƒ¨è®¡ç®—é€»è¾‘     return output\n\nå³è¾“å…¥ä¸€æ®µtoken\n\nå…³äº token\ntoken å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå¥å­ä¸­æœ€å°çš„ç»„æˆéƒ¨åˆ†ã€‚é€šå¸¸ä¸ºä¸€ä¸ªè¯ï¼Œä¸€äº›æƒ…å†µä¸‹ï¼Œå¯ä»¥è¿›è¡Œç®€åŒ–ï¼Œä¾‹å¦‚åç»­ä½¿ç”¨èå£«æ¯”äºšçš„ä½œå“é›†è¿›è¡Œè®­ç»ƒæ—¶ï¼Œå°†å­—ç¬¦ä½œä¸º tokenã€‚\n\ntoken é€šè¿‡åˆ†è¯å™¨æ¥è·å–ï¼Œå¯¹åº”ä¸€ä¸ªè¯æ±‡è¡¨ã€‚æœ€å¼€å§‹è¾“å…¥åˆ°æ¨¡å‹ä¸­çš„åºåˆ—å…¶å®ä¸ºä¸€ä¸²æ•°å­—ï¼Œè¡¨ç¤ºå½“å‰ token åœ¨è¯æ±‡è¡¨ä¸­çš„ä½ç½®ã€‚ä¾‹å¦‚ï¼š\n# è¯æ±‡è¡¨ä¸­çš„tokenç´¢å¼•è¡¨ç¤ºè¯¥tokençš„æ•´æ•°ID# ä¾‹å¦‚ï¼Œ&quot;robot&quot;çš„æ•´æ•°IDä¸º1ï¼Œå› ä¸ºvocab[1] = &quot;robot&quot;vocab = [&quot;must&quot;, &quot;robot&quot;, &quot;obey&quot;, &quot;the&quot;, &quot;orders&quot;, &quot;.&quot;]# è¿›è¡Œåˆ†è¯çš„åˆ†è¯å™¨tokenizerï¼ˆå‡è®¾é€šè¿‡ç©ºæ ¼æ¥è¿›è¡Œåˆ†è¯ï¼‰tokenizer = WhitespaceTokenizer(vocab)# encode()æ–¹æ³•å°†strå­—ç¬¦ä¸²è½¬æ¢ä¸ºlist[int]ids = tokenizer.encode(&quot;robot must obey orders&quot;) # ids = [1, 0, 2, 4]# é€šè¿‡è¯æ±‡è¡¨æ˜ å°„ï¼Œå¯ä»¥çœ‹åˆ°å®é™…çš„tokenæ˜¯ä»€ä¹ˆtokens = [tokenizer.vocab[i] for i in ids] # tokens = [&quot;robot&quot;, &quot;must&quot;, &quot;obey&quot;, &quot;orders&quot;]# decode()æ–¹æ³•å°†list[int] è½¬æ¢å›strtext = tokenizer.decode(ids) # text = &quot;robot must obey orders&quot;\n\nåŒæ ·ï¼Œè¾“å‡ºä¸ºä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œè¡¨ç¤ºå½“å‰ä½ç½®ä¸åŒ token çš„å‡ºç°æ¦‚ç‡ã€‚output æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå…¶ä¸­ output[i][j] è¡¨ç¤ºæ–‡æœ¬åºåˆ—çš„ç¬¬ i ä¸ªä½ç½®çš„ tokenï¼ˆinputs[i]ï¼‰æ˜¯è¯æ±‡è¡¨çš„ç¬¬ j ä¸ª tokenï¼ˆvocab[j]ï¼‰çš„æ¦‚ç‡ï¼ˆå®é™…ä¸ºæœªå½’ä¸€åŒ–çš„logitså¾—åˆ†ï¼‰ã€‚ä¾‹å¦‚ï¼š\ninputs = [1, 0, 2, 4]  # &quot;robot&quot; &quot;must&quot; &quot;obey&quot; &quot;orders&quot;vocab = [&quot;must&quot;, &quot;robot&quot;, &quot;obey&quot;, &quot;the&quot;, &quot;orders&quot;, &quot;.&quot;]output = gpt(inputs)# output[0] = [0.75, 0.1, 0.15, 0.0, 0.0, 0.0]# ç»™å®š &quot;robot&quot;ï¼Œæ¨¡å‹é¢„æµ‹ &quot;must&quot; çš„æ¦‚ç‡æœ€é«˜# output[1] = [0.0, 0.0, 0.8, 0.1, 0.0, 0.1]# ç»™å®šåºåˆ— [&quot;robot&quot;, &quot;must&quot;]ï¼Œæ¨¡å‹é¢„æµ‹ &quot;obey&quot; çš„æ¦‚ç‡æœ€é«˜# output[-1] = [0.0, 0.0, 0.1, 0.0, 0.85, 0.05]# ç»™å®šæ•´ä¸ªåºåˆ—[&quot;robot&quot;, &quot;must&quot;, &quot;obey&quot;]ï¼Œæ¨¡å‹é¢„æµ‹ &quot;orders&quot; çš„æ¦‚ç‡æœ€é«˜next_token_id = np.argmax(output[-1])  # next_token_id = 4next_token = vocab[next_token_id]      # next_token = &quot;orders&quot;\nåœ¨æ¨ç†æ—¶ï¼ˆç”Ÿæˆæ–‡æœ¬ï¼‰ï¼Œé¦–å…ˆå°† prompt è¾“å…¥ GPTï¼Œç„¶åè¿­ä»£åœ°å°†ä¸Šä¸€è½®çš„è¾“å‡ºæ”¾åˆ°å½“å‰çš„æœ«å°¾ï¼Œé‡å¤ç”Ÿæˆã€‚ä¾‹å¦‚ï¼š\ndef generate(inputs, n_tokens_to_generate):\t&quot;&quot;&quot; GPTç”Ÿæˆä»£ç \tinputs: list[int], è¾“å…¥æ–‡æœ¬çš„token idsåˆ—è¡¨\tn_tokens_to_generateï¼šint, éœ€è¦ç”Ÿæˆçš„tokenæ•°é‡\t&quot;&quot;&quot;    # è‡ªå›å½’å¼è§£ç å¾ªç¯    for _ in range(n_tokens_to_generate):         output = gpt(inputs)            # æ¨¡å‹å‰å‘æ¨ç†ï¼Œè¾“å‡ºé¢„æµ‹è¯è¡¨å¤§å°çš„logitsåˆ—è¡¨        next_id = np.argmax(output[-1]) # è´ªå¿ƒé‡‡æ ·        inputs.append(int(next_id))     # å°†é¢„æµ‹æ·»åŠ å›è¾“å…¥    return inputs[len(inputs) - n_tokens_to_generate :]  # åªè¿”å›ç”Ÿæˆçš„ids# éšä¾¿ä¸¾ä¾‹input_ids = [1, 0, 2]                          # [&quot;robot&quot;, &quot;must&quot;, &quot;obey&quot;]output_ids = generate(input_ids, 1)            #  output_ids = [1, 0, 2, 4]output_tokens = [vocab[i] for i in output_ids] # [&quot;robot&quot;, &quot;must&quot;, &quot;obey&quot;, &quot;orders&quot;]\n\nä»£ç é¦–å…ˆï¼Œæœ€å¤–å±‚è°ƒç”¨çš„æ˜¯ GPT ç±»ã€‚è°ƒç”¨æ–¹æ³•ä¸ºï¼š\nlogits, loss = model(X, Y)\nå…¶ä¸­ Xï¼ŒY è¡¨ç¤ºè¾“å…¥ä»¥åŠå…¶å¯¹åº”çš„æ ‡ç­¾ï¼Œæ³¨æ„è¿™é‡Œå·²ç»ä¸º int ç±»å‹çš„æ•°ç»„äº†ï¼ˆè¡¨ç¤º token åœ¨è¯æ±‡è¡¨ä¸­çš„ä½ç½®ï¼‰ã€‚\nGPT ç±»æ•´ä½“ç»“æ„def forward(self, idx, targets=None):    device = idx.device    b, t = idx.size()    assert t &lt;= self.config.block_size, f&quot;Cannot forward sequence of length &#123;t&#125;, block size is only &#123;self.config.block_size&#125;&quot;    pos = torch.arange(0, t, dtype=torch.long, device=device)    tok_emb = self.transformer.wte(idx)     pos_emb = self.transformer.wpe(pos)     x = self.transformer.drop(tok_emb + pos_emb)    for block in self.transformer.h:        x = block(x)    x = self.transformer.ln_f(x)    if targets is not None:        logits = self.lm_head(x)        loss = F.cross_entropy(logits.view(-1, logits.size(-1)), targets.view(-1), ignore_index=-1)    else:        logits = self.lm_head(x[:, [-1], :]) # note: using list [-1] to preserve the time dim        loss = None    return logits, loss\n\nè¾“å…¥ idx ç±»å‹ä¸º list[int]ï¼Œè¡¨ç¤ºè¾“å…¥ token åœ¨è¯æ±‡è¡¨ä¸­çš„ç´¢å¼•ï¼Œå¹¶ä¸”æœ‰ batch ç»´åº¦ã€‚æ­¤å¤„æœ‰ä¸€ä¸ªæ–­è¨€ï¼Œå³è¦æ±‚åºåˆ—çš„é•¿åº¦è¦å°äºå—é•¿åº¦ï¼Œå³ block_size è¡¨ç¤ºæ¨¡å‹èƒ½å¤„ç†çš„æœ€å¤§é•¿åº¦ã€‚\næ–°å»ºä¸€ä¸ªä½ç½®æ•°ç»„ psoï¼Œç”¨äºè®¡ç®—ä½ç½®ç¼–ç ã€‚\næ¥ä¸‹æ¥ä¸ºæ ¸å¿ƒä»£ç  self.transformerï¼Œå®ç°å¦‚ä¸‹self.transformer = nn.ModuleDict(dict(    wte = nn.Embedding(config.vocab_size, config.n_embd),    wpe = nn.Embedding(config.block_size, config.n_embd),    drop = nn.Dropout(config.dropout),    h = nn.ModuleList([Block(config) for _ in range(config.n_layer)]),    ln_f = LayerNorm(config.n_embd, bias=config.bias),))\nå…¶åŒ…å« 5 ä¸ªéƒ¨åˆ†ï¼štoken ç¼–ç ï¼ˆword token embedding, wteï¼‰ã€ä½ç½®ç¼–ç ï¼ˆword position embedding, wpeï¼‰ã€dropoutã€æ³¨æ„åŠ›å—ï¼ˆblockï¼‰å’Œå±‚å½’ä¸€åŒ–ã€‚\næ•´ä½“å¤„ç†æµç¨‹ä¸ºï¼š\ntoken ç¼–ç  + ä½ç½®ç¼–ç ï¼Œå¹¶ç›¸åŠ \nä¾æ¬¡é€šè¿‡æ³¨æ„åŠ›å±‚\nç»è¿‡æœ€ç»ˆçš„æ˜ å°„å±‚ï¼ˆå°†æ³¨æ„åŠ›çš„è¾“å‡ºæ˜ å°„åˆ°è¯æ±‡è¡¨ç»´åº¦ï¼‰\næœ€åè¿›è¡Œåˆ¤æ–­æ˜¯å¦è®¡ç®— loss\n\n\n\ntoken ç¼–ç å’Œä½ç½®ç¼–ç \ntoken ç¼–ç ï¼šwte æ˜¯ä¸€ä¸ª [n_vocab, n_embd] å¤§å°çš„å¯å­¦ä¹ å‚æ•°çŸ©é˜µï¼Œå®ƒå……å½“ä¸€ä¸ª token åµŒå…¥æŸ¥æ‰¾è¡¨ï¼Œå…¶ä¸­çŸ©é˜µçš„ç¬¬ i å¯¹åº”äºè¯æ±‡è¡¨ä¸­ç¬¬ i ä¸ª token çš„ embeddingã€‚\nwte[idx] ä½¿ç”¨ Token Ids åˆ—è¡¨ç´¢å¼•æ¥æ£€ç´¢ä¸è¾“å…¥ä¸­æ¯ä¸ªtokenå¯¹åº”çš„å‘é‡ã€‚\n\n\nä½ç½®ç¼–ç ï¼šè¡¨ç¤ºåºåˆ—çš„å…ˆåä¿¡æ¯ï¼ŒåŒæ ·æ˜¯ä¸€ä¸ª [n_block, n_embd] å¤§å°çš„å¯å­¦ä¹ å‚æ•°çŸ©é˜µã€‚\n\nBlock ç±»\nBlock ç±»çš„å®ç°å¦‚ä¸‹ï¼šclass Block(nn.Module):    def __init__(self, config):        super().__init__()        self.ln_1 = LayerNorm(config.n_embd, bias=config.bias)        self.attn = CausalSelfAttention(config)        self.ln_2 = LayerNorm(config.n_embd, bias=config.bias)        self.mlp = MLP(config)    def forward(self, x):        x = x + self.attn(self.ln_1(x))        x = x + self.mlp(self.ln_2(x))        return x\nå…¶ä¸»è¦åŒ…å«ä¸¤ä¸ªå±‚å½’ä¸€åŒ–ã€MLPå’Œæ³¨æ„åŠ›å±‚ã€‚\n\nCausalSelfAttention ç±»å®ç°æ³¨æ„åŠ›æœºåˆ¶çš„æ ¸å¿ƒç±»ã€‚\ndef forward(self, x):    B, T, C = x.size() # batch size, sequence length, embedding dimensionality (n_embd)    # calculate query, key, values for all heads in batch and move head forward to be the batch dim    q, k, v  = self.c_attn(x).split(self.n_embd, dim=2)    k = k.view(B, T, self.n_head, C // self.n_head).transpose(1, 2) # (B, nh, T, hs)    q = q.view(B, T, self.n_head, C // self.n_head).transpose(1, 2) # (B, nh, T, hs)    v = v.view(B, T, self.n_head, C // self.n_head).transpose(1, 2) # (B, nh, T, hs)    # causal self-attention; Self-attend: (B, nh, T, hs) x (B, nh, hs, T) -&gt; (B, nh, T, T)    if self.flash:        # efficient attention using Flash Attention CUDA kernels        y = torch.nn.functional.scaled_dot_product_attention(q, k, v, attn_mask=None, dropout_p=self.dropout if self.training else 0, is_causal=True)    else:        # manual implementation of attention        att = (q @ k.transpose(-2, -1)) * (1.0 / math.sqrt(k.size(-1)))        att = att.masked_fill(self.bias[:,:,:T,:T] == 0, float(&#x27;-inf&#x27;))        att = F.softmax(att, dim=-1)        att = self.attn_dropout(att)        y = att @ v # (B, nh, T, T) x (B, nh, T, hs) -&gt; (B, nh, T, hs)    y = y.transpose(1, 2).contiguous().view(B, T, C) # re-assemble all head outputs side by side    # output projection    y = self.resid_dropout(self.c_proj(y))    return y\n\nself.c_attn(x) è¡¨ç¤ºä¸ºæ³¨æ„åŠ›æœºåˆ¶çš„æ˜ å°„å±‚ï¼Œå¹¶å°† Qã€Kã€V ä¸‰ä¸ªæ˜ å°„å±‚åˆå¹¶ä¸ºä¸€ä¸ªï¼Œå‡å°‘è®¡ç®—é‡ã€‚è®¡ç®—å‡ºæ˜ å°„çŸ©é˜µåå†è¿›è¡Œåˆ’åˆ†ã€‚\nself.c_attn = nn.Linear(config.n_embd, 3 * config.n_embd, bias=config.bias)\n\næ¥ä¸‹æ¥æ ¹æ® head çš„æ•°é‡å¯¹æ˜ å°„çŸ©é˜µè¿›è¡Œåˆ’åˆ†ã€‚ç„¶åå°±æ˜¯è®¡ç®—æ³¨æ„åŠ›ã€‚\n\næ³¨æ„ï¼Œä¸ºäº†å®ç°å› æœæœºåˆ¶ï¼Œå³æ¨¡å‹åªèƒ½çœ‹åˆ°å½“å‰ token ä¹‹å‰çš„ tokenï¼Œéœ€è¦å°†è®¡ç®—å‡ºçš„ attn çŸ©é˜µ mask ä¸€éƒ¨åˆ†ã€‚\n# è¾“å…¥æ˜¯ [&quot;not&quot;, &quot;all&quot;, &quot;heroes&quot;, &quot;wear&quot;, &quot;capes&quot;] # åŸå§‹è‡ªæ³¨æ„åŠ›        not    all   heroes  wear  capes   not 0.116  0.159  0.055  0.226  0.443   all 0.180  0.397  0.142  0.106  0.175heroes 0.156  0.453  0.028  0.129  0.234  wear 0.499  0.055  0.133  0.017  0.295 capes 0.089  0.290  0.240  0.228  0.153 # å› æœè‡ªæ³¨æ„åŠ› ï¼ˆè¡Œä¸ºj, åˆ—ä¸ºiï¼‰ # ä¸ºé˜²æ­¢è¾“å…¥çš„æ‰€æœ‰æŸ¥è¯¢éƒ½èƒ½é¢„æµ‹æœªæ¥ï¼Œéœ€è¦å°†æ‰€æœ‰j&gt;iä½ç½®è®¾ç½®ä¸º0 ï¼š        not    all   heroes  wear  capes   not 0.116  0.     0.     0.     0.   all 0.180  0.397  0.     0.     0.heroes 0.156  0.453  0.028  0.     0.  wear 0.499  0.055  0.133  0.017  0. capes 0.089  0.290  0.240  0.228  0.153 # åœ¨åº”ç”¨ softmax ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹æˆ‘ä»¬çš„æ³¨æ„åŠ›çŸ©é˜µï¼Œå¾—åˆ°æ©ç è‡ªæ³¨æ„åŠ› # å³ï¼Œåœ¨softmaxä¹‹å‰å°†è¦å±è”½é¡¹çš„æ³¨æ„åŠ›å¾—åˆ†è®¾ç½®ä¸º âˆ’âˆï¼ˆå½’ä¸€åŒ–ç³»æ•°ä¸º0ï¼‰ # maskæ©ç çŸ©é˜µ 0 -1e10 -1e10 -1e10 -1e10 0   0   -1e10 -1e10 -1e10 0   0     0   -1e10 -1e10 0   0     0     0   -1e10 0   0     0     0     0 ä½¿ç”¨ -1e10 è€Œä¸æ˜¯ -np.inf ï¼Œå› ä¸º -np.inf å¯èƒ½ä¼šå¯¼è‡´ nans\n\nè‡³æ­¤ï¼Œæ•´ä¸ª GPT çš„ç»“æ„æ‹†è§£å®Œæ¯•ã€‚\n","categories":["LLM"],"tags":["LLM"]},{"title":"ã€ä»£ç éšæƒ³å½•ã€‘æ•°ç»„1-äºŒåˆ†æŸ¥æ‰¾","url":"/blog/Leetcode/array1/","content":"åŸºæœ¬çŸ¥è¯†\næ•°ç»„å…ƒç´ æŒ‰ç…§é¡ºåºæ’åˆ—\næ•°ç»„å…ƒç´ æ— æ³•åˆ é™¤ï¼Œåªèƒ½æ›¿ä»£ï¼ˆå¡«å……ï¼‰\npython ä¸­ï¼Œä½¿ç”¨ listï¼Œä»£ç ä¸­ List æ˜¯ç±»å‹æ³¨è§£ä¸­çš„ä¸€ç§è¡¨ç¤ºæ–¹å¼ï¼Œé€šå¸¸å‡ºç°åœ¨ç±»å‹æç¤ºä¸­ã€‚python 3.9 ä¹‹åå¯ä»¥ä½¿ç”¨å†…ç½®çš„ list æ¥æ›¿ä»£ Listã€‚\n\n704. äºŒåˆ†æŸ¥æ‰¾\né¢˜ç›®é“¾æ¥ link\n\nç»™å®šä¸€ä¸ª n ä¸ªå…ƒç´ æœ‰åºçš„ï¼ˆå‡åºï¼‰æ•´å‹æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ target  ï¼Œå†™ä¸€ä¸ªå‡½æ•°æœç´¢ nums ä¸­çš„ targetï¼Œå¦‚æœç›®æ ‡å€¼å­˜åœ¨è¿”å›ä¸‹æ ‡ï¼Œå¦åˆ™è¿”å› -1ã€‚\n\nè¾“å…¥: nums &#x3D; [-1,0,3,5,9,12], target &#x3D; 9è¾“å‡º: 4è§£é‡Š: 9 å‡ºç°åœ¨ nums ä¸­å¹¶ä¸”ä¸‹æ ‡ä¸º 4     \n\nä¸¤ä¸ªè¦ç‚¹\næ•°ç»„ä¸­å…ƒç´ æŒ‰ç…§é¡ºåºæ’åˆ—\næ— é‡å¤çš„æ•°å­—ï¼ˆå¦åˆ™å…ƒç´ ä¸‹æ ‡ä¸å”¯ä¸€ï¼‰\nå¦‚æœæœ‰é‡å¤çš„æ•°å­—ï¼Œè¦æ±‚è¿”å›æœ€å°çš„é‚£ä¸ªå‘¢ï¼Ÿ\n\n\n\nè§£æ³•\nåŒºé—´å®šä¹‰ï¼šå®šä¹‰ target æ‰€åœ¨çš„åŒºé—´æ˜¯å·¦é—­å³å¼€è¿˜æ˜¯å·¦å³å…¨é—­\næ ¸å¿ƒï¼šå°†æ•°ç»„åˆ†å‰²ä¸ºä¸‰ä¸ªéƒ¨åˆ†\nå·¦å³å…¨é—­ï¼š[0, middle-1] , middle, [middle + 1, len - 1] æˆ–è€…\nå·¦å¼€å³é—­ï¼š[0, middle) , middle, [middle + 1, len)\n\n\n\nå·¦å³å…¨é—­\nåŒºé—´ä¸º [left, right]ï¼š\nå®šä¹‰ right ä¸º len(nums) - 1ï¼Œå› ä¸º right è¦æœ‰å«ä¹‰\nå¾ªç¯æ¡ä»¶ while(left &lt;&#x3D; right) ï¼Œå› ä¸ºleft &#x3D;&#x3D; rightæ˜¯æœ‰æ„ä¹‰çš„\nåˆ¤æ–­æ¡ä»¶ï¼Œè‹¥ middle å¤§äº target ï¼Œåˆ™éå†å·¦åŒºé—´ï¼Œè®¾ç½® right &#x3D; middle - 1ï¼Œå› ä¸ºæ­¤æ—¶ä¸ºå³é—­åŒºé—´ï¼Œä¸ä¼šå†è®¿é—® middleï¼›åŒç†ï¼Œè‹¥ middle å°äº targetï¼Œåˆ™éå†å³è¾¹åŒºé—´ï¼Œè®¾ç½® left &#x3D; middle + 1ï¼ŒåŒæ ·å› ä¸ºæ˜¯é—­åŒºé—´ï¼Œä¸ä¼šå†è®¿é—® middleã€‚\n\n\nä»£ç ï¼šclass Solution:    def search(self, nums: List[int], target: int) -&gt; int:        left = 0        right = len(nums) - 1        while left &lt;= right:            middle = int((left + right) / 2)            if nums[middle] &gt; target:                right = middle - 1            elif nums[middle] &lt; target:                left = middle + 1            else:                return middle        return -1        \n\nå·¦é—­å³å¼€\nåŒºé—´ä¸º [left, right)ï¼š\n\nå®šä¹‰ right ä¸º len(nums)ï¼Œå› ä¸ºä¸ä¼šè®¿é—® rightï¼Œæ‰€ä»¥è®¾ç½®ä¸ºåŒºé—´é•¿åº¦\nå¾ªç¯æ¡ä»¶ while(left &lt; right) ï¼Œå› ä¸ºleft &#x3D;&#x3D; rightæ²¡æœ‰æ„ä¹‰ï¼ˆå³è¾¹ä¸ºå¼€åŒºé—´ï¼‰\nåˆ¤æ–­æ¡ä»¶ï¼Œè‹¥ middle å¤§äº target ï¼Œåˆ™éå†å·¦åŒºé—´ï¼Œè®¾ç½® right &#x3D; middleï¼Œå› ä¸ºæ­¤æ—¶ä¸ºå³å¼€åŒºé—´ï¼Œè®¾ç½® right&#x3D;middle å®é™…ä¸Šä¸‹ä¸€æ¬¡ä¼šè®¿é—® middle - 1 ã€‚\n\n\nä»£ç ï¼š\nclass Solution:    def search(self, nums: List[int], target: int) -&gt; int:        left = 0        right = len(nums)        while left &lt; right:            middle = int((left + right) / 2)            if nums[middle] &gt; target:                right = middle            elif nums[middle] &lt; target:                left = middle + 1            else:                return middle        return -1 \n\nç›¸å…³é¢˜ç›®1ï¼š35. æœç´¢æ’å…¥ä½ç½®\né¢˜ç›®é“¾æ¥ link\n\nç»™å®šä¸€ä¸ªæ’åºæ•°ç»„å’Œä¸€ä¸ªç›®æ ‡å€¼ï¼Œåœ¨æ•°ç»„ä¸­æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œå¹¶è¿”å›å…¶ç´¢å¼•ã€‚å¦‚æœç›®æ ‡å€¼ä¸å­˜åœ¨äºæ•°ç»„ä¸­ï¼Œè¿”å›å®ƒå°†ä¼šè¢«æŒ‰é¡ºåºæ’å…¥çš„ä½ç½®ã€‚\nä½ å¯ä»¥å‡è®¾æ•°ç»„ä¸­æ— é‡å¤å…ƒç´ ã€‚\nè¦ç‚¹\næ— é‡å¤å…ƒç´  + å‡åºæ’åˆ—ï¼Œè€ƒè™‘äºŒåˆ†æŸ¥æ‰¾\n\nè¿™é“é¢˜ç›¸è¾ƒäºäºŒåˆ†æŸ¥æ‰¾ï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ª target ä¸å­˜åœ¨çš„æƒ…å†µï¼Œåœ¨è¿™ä¸ªæƒ…å†µä¸‹ï¼Œä¸€å®šæ»¡è¶³ left &#x3D;&#x3D; right + 1 ï¼ˆå·¦å³éƒ½ä¸ºé—­åŒºé—´çš„æƒ…å†µï¼‰\n\nå› ä¸ºï¼Œåœ¨å¾ªç¯çš„æœ€åä¸€è½®ï¼Œæ»¡è¶³ left &#x3D;&#x3D; rightï¼Œæ­¤æ—¶ åªå‰©ä¸‹æœ€åä¸€ä¸ªæ•°å­—ï¼Œmiddle ä¹Ÿä¸º left ï¼ˆrightï¼‰ã€‚æ­¤æ—¶è‹¥ middle æ•°å°äº targetï¼Œåˆ™ left + 1ï¼Œåä¹‹åˆ™ right - 1ã€‚\nåŸºäºè¿™ä¸ªåŸç†ï¼Œè‹¥ middle æ•°å°äº targetï¼Œtarget åº”è¯¥æ”¾åœ¨ middle + 1 ä¸Šï¼Œè‹¥ middle æ•°å¤§äº targetï¼Œåˆ™ target åº”è¯¥æ”¾åœ¨ middle ä¸Š\nå¯¹æ¯”ä¸Šè¿°ä¸¤æ¡ï¼Œå¯ä»¥å‘ç°ï¼š\nmiddle æ•°å°äº targetï¼Œleft + 1ï¼Œæ”¾åœ¨ middle + 1çš„ä½ç½®\nmiddle æ•°å¤§äº targetï¼Œ right - 1, middle ä¸å˜ï¼Œæ”¾åœ¨ middle çš„ä½ç½®\nmiddle çš„å˜åŒ–å’Œ left ç›¸åŒï¼Œå³å°äºæ—¶åŠ 1ï¼Œå¤§äºæ—¶ä¸å˜ï¼Œè€Œæœ€åä¸€è½®å¾ªç¯æ—¶ middleã€leftã€right å‡ç›¸åŒï¼Œåˆ™æœ€åçš„ç»“æœä¸€å®šä¸º leftã€‚\n\n\n\n\nä»£ç å¦‚ä¸‹ï¼Œåªéœ€å°†äºŒåˆ†æŸ¥æ‰¾çš„ä»£ç çš„æœ€åä¸€è¡Œï¼Œæ”¹ä¸º return left å³å¯\nclass Solution:    def search(self, nums: List[int], target: int) -&gt; int:        left = 0        right = len(nums) - 1        while left &lt;= right:            middle = int((left + right) / 2)            if nums[middle] &gt; target:                right = middle - 1            elif nums[middle] &lt; target:                left = middle + 1            else:                return middle        return left\n\nç›¸å…³é¢˜ç›®2ï¼š34. åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½®\né¢˜ç›®é“¾æ¥ linkç»™å®šä¸€ä¸ªæŒ‰ç…§å‡åºæ’åˆ—çš„æ•´æ•°æ•°ç»„ numsï¼Œå’Œä¸€ä¸ªç›®æ ‡å€¼ targetã€‚æ‰¾å‡ºç»™å®šç›®æ ‡å€¼åœ¨æ•°ç»„ä¸­çš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚\n\nå¦‚æœæ•°ç»„ä¸­ä¸å­˜åœ¨ç›®æ ‡å€¼ targetï¼Œè¿”å› [-1, -1]ã€‚\nè¿›é˜¶ï¼šä½ å¯ä»¥è®¾è®¡å¹¶å®ç°æ—¶é—´å¤æ‚åº¦ä¸º $O(\\log n)$ çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜å—ï¼Ÿ\nç¤ºä¾‹ 1ï¼š\n\nè¾“å…¥ï¼šnums &#x3D; [5,7,7,8,8,10], target &#x3D; 8è¾“å‡ºï¼š[3,4]\n\nç¤ºä¾‹ 2ï¼š\n\nè¾“å…¥ï¼šnums &#x3D; [5,7,7,8,8,10], target &#x3D; 6è¾“å‡ºï¼š[-1,-1]\n\nç¤ºä¾‹ 3ï¼š\n\nè¾“å…¥ï¼šnums &#x3D; [], target &#x3D; 0è¾“å‡ºï¼š[-1,-1]\n\næ€è·¯\nç›¸ä¼¼äºäºŒåˆ†æŸ¥æ‰¾ï¼Œåˆ†åˆ«æ‰¾å·¦è¾¹ç•Œå’Œå³è¾¹ç•Œï¼Œæ‰¾åˆ°ä¸€ä¸ªç›®æ ‡å\nè‹¥è¦æ‰¾å·¦è¾¹ç•Œï¼Œåˆ™åœ¨æ‰¾åˆ°çš„ç›®æ ‡çš„å·¦è¾¹æ•°ç»„ä¸­å†æ¬¡æŸ¥æ‰¾ï¼Œright &#x3D; middle - 1ã€‚å³è®¤ä¸ºå½“å‰æ‰¾åˆ°çš„æ•°æ¯”å®é™…çš„ target å¤§ã€‚\nç›¸ä¼¼çš„ï¼Œè‹¥è¦æ‰¾å³è¾¹ç•Œï¼Œåˆ™åœ¨æ‰¾åˆ°çš„ç›®æ ‡çš„å³è¾¹æ•°ç»„ä¸­å†æ¬¡æŸ¥æ‰¾ï¼Œleft &#x3D; middle + 1ã€‚å³è®¤ä¸ºå½“å‰æ‰¾åˆ°çš„æ•°æ¯”å®é™…çš„ target å°ã€‚class Solution:    def searchRange(self, nums: List[int], target: int) -&gt; int:                leftb = mySearch(nums, target, True)        rightb = mySearch(nums, target, False)        def mySearch(nums: List[int], target: int, side: bool):            left = 0            right = len(nums) - 1            res = -1            while left &lt;= right:                middle = int((left + right) / 2)                if nums[middle] &gt; target:                    right = middle - 1                elif nums[middle] &lt; target:                    left = middle + 1                else:                    res = middle                    if side:                        # å·¦è¾¹ç•Œ                        right = middle - 1                    else:                        left = middle + 1            return res        return [leftb, rightb]\n\n\n\nç›¸å…³é¢˜ç›®3ï¼š367. æœ‰æ•ˆçš„å®Œå…¨å¹³æ–¹æ•°\né¢˜ç›®é“¾æ¥ linkç»™ä½ ä¸€ä¸ªéè´Ÿæ•´æ•° x ï¼Œè®¡ç®—å¹¶è¿”å› x çš„ ç®—æœ¯å¹³æ–¹æ ¹ ã€‚\n\nç”±äºè¿”å›ç±»å‹æ˜¯æ•´æ•°ï¼Œç»“æœåªä¿ç•™ æ•´æ•°éƒ¨åˆ† ï¼Œå°æ•°éƒ¨åˆ†å°†è¢« èˆå» ã€‚\næ³¨æ„ï¼šä¸å…è®¸ä½¿ç”¨ä»»ä½•å†…ç½®æŒ‡æ•°å‡½æ•°å’Œç®—ç¬¦ï¼Œä¾‹å¦‚ pow(x, 0.5) æˆ–è€… x ** 0.5 ã€‚\nç¤ºä¾‹ 1ï¼š\n\nè¾“å…¥ï¼šx &#x3D; 4è¾“å‡ºï¼š2\n\nç¤ºä¾‹ 2ï¼š\n\nè¾“å…¥ï¼šx &#x3D; 8è¾“å‡ºï¼š2è§£é‡Šï¼š8 çš„ç®—æœ¯å¹³æ–¹æ ¹æ˜¯ 2.82842â€¦, ç”±äºè¿”å›ç±»å‹æ˜¯æ•´æ•°ï¼Œå°æ•°éƒ¨åˆ†å°†è¢«èˆå»ã€‚\n\næ€è·¯\näºŒåˆ†æŸ¥æ‰¾ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªå¹³æ–¹ä¸å¤§äº x çš„æ•°å­—ã€‚class Solution:    def mySqrt(self, x: int) -&gt; int:        left = 0        right = x - 1        if x == 0: return 0        if x == 1: return 1        while left &lt;= right:            middle = int((left + right) / 2)            if middle * middle &gt; x:                right = middle - 1            elif middle * middle &lt; x:                left = middle + 1            else:                return middle        return right        \n\n","categories":["Leetcode"],"tags":["Array"]},{"title":"ã€ML2025ã€‘1-ç”Ÿæˆå¼äººå·¥æ™ºèƒ½","url":"/blog/ML2025/gen-AI/","content":"\næå®æ¯…è€å¸ˆã€Šæœºå™¨å­¦ä¹ ã€‹2025å­¦ä¹ è®°å½•\n\n\nç”Ÿæˆå¼äººå·¥æ™ºèƒ½æœ‰ä»€ä¹ˆæ ·çš„è¡Œä¸ºï¼Ÿ\nç°æœ‰çš„æ¨¡å‹é€šå¸¸ä¼šä½“ç°â€œæ€è€ƒâ€çš„è¿‡ç¨‹ï¼ˆè„‘å†…å°å‰§åœºï¼Ÿï¼Ÿï¼‰ã€‚\næœªæ¥ AI çš„å·¥ä½œä¸å†å±€é™äºâ€œä¸€é—®ä¸€ç­”â€ï¼Œå¾ˆå¤šä»»åŠ¡éœ€è¦å¤šä¸ªæ­¥éª¤æ¥å®Œæˆ â€“&gt; AI agent\nä½¿ç”¨ AI agent æ¥è®­ç»ƒæ¨¡å‹ï¼Ÿï¼Ÿ\n\nè¿ä½œæœºåˆ¶\nç”Ÿæˆå¼äººå·¥æ™ºèƒ½çš„åŸºæœ¬åŸç†ï¼šè¾“å…¥ä¸€æ®µ tokenï¼Œè¾“å‡ºå¦ä¸€æ®µ tokenã€‚ä»»ä½•äº‹ç‰©éƒ½å¯ä»¥ç”±å¤šä¸ª token è¡¨ç¤ºï¼š\nThose tokens were words, some of the tokens of course could now be images, or charts, or tables, songs â€¦ speech, videos. Those tokens could be anything.Â token å¯ä»¥æ˜¯å•è¯ï¼Œå›¾ç‰‡ã€è¡¨ã€æ­Œæ›²ã€å¯¹è¯ç­‰ç­‰â€¦â€¦\n\n\n\n\n\nä¸è®ºä»€ä¹ˆä»»åŠ¡ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯ token åˆ° tokenã€‚\n\nå…·ä½“æ¥è¯´ï¼Œæ˜¯ç»™è¾“å…¥ token åºåˆ—ï¼Œé¢„æµ‹ä¸‹ä¸€ä¸ª tokenã€‚\nç„¶åå°†é¢„æµ‹çš„ token ä¸è¾“å…¥çš„ token åºåˆ—æ‹¼æ¥ï¼Œç„¶åå†æ¬¡è¾“å…¥åˆ°æ¨¡å‹ä¸­ï¼Œé¢„æµ‹ä¸‹ä¸€ä¸ª tokenï¼Œé‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œç›´åˆ°ç»“æŸã€‚\n\n\nä¾‹å¦‚ï¼Œè¾“å…¥å›¾åƒï¼Œè¾“å‡ºæ–‡å­—ï¼Œé‚£ä¹ˆ z å°±ä»£è¡¨æ‰€æœ‰æ–‡å­— token å’Œå›¾åƒ token çš„é›†åˆ\n\né€šå¸¸æ˜¯ä½¿ç”¨æ·±åº¦ç½‘ç»œæ¥é¢„æµ‹ä¸‹ä¸€ä¸ª tokenã€‚ä¸€ä¸ªä¸æ°å½“çš„æ¯”å–»ï¼Œå‡è®¾ä»»åŠ¡ä¸ºä¸‰ä¸ªæ•°å­—ç›¸åŠ ï¼Œæ¯ä¸€ä¸ªå±‚ä¸ºä¸€ä¸ªæŸ¥è¡¨æ“ä½œï¼Œå¦‚æœåªç”¨ä¸€ä¸ªå±‚ï¼Œé‚£ä¹ˆéœ€è¦å­˜10^3ç§å¯èƒ½ï¼Œå¦‚æœåˆ†ä¸ºä¸¤å±‚ï¼Œé‚£ä¹ˆåªéœ€è¦10*10+19*10ç§å¯èƒ½ã€‚\n\næœ¬è´¨ä¸Šï¼Œè®©æ¨¡å‹â€œæ€è€ƒâ€ï¼ˆreasonï¼‰ä¹Ÿæ˜¯ä¸€ç§â€œæ·±åº¦â€ã€‚\n\nå›°éš¾çš„é—®é¢˜éœ€è¦æ€è€ƒå¾ˆå¤šæ­¥ï¼Œlayer çš„æ·±åº¦ä¸å¤Ÿäº†ï¼Ÿ\næ·±åº¦ä¸å¤Ÿï¼Œé•¿åº¦æ¥å‡‘ï¼\n\n\n\nå†…å®¹æ˜¯æ€æ ·äº§ç”Ÿå‡ºæ¥çš„ï¼Ÿ\næˆ‘ä»¬è¦æ€æ ·å¾—åˆ°å¯ä»¥ç”Ÿæˆå†…å®¹çš„æ¨¡å‹ï¼Ÿä¸‰æ­¥èµ°ï¼\nFind Function with Unknown Parameters\nDefine Loss from Training Data\nOptimation\n\n\nç”Ÿæˆå¼æ¨¡å‹ä¹Ÿä¸æ˜¯æ–°çš„é—®é¢˜ï¼šä»â€œä¸“æ‰â€åˆ°â€œé€šæ‰â€çš„è½¬å˜\nå¦‚ä½•å®ç°è¿™ä¸ªè½¬å˜ï¼Ÿå¤§æ¦‚åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªé˜¶æ®µ\né˜¶æ®µä¸€ï¼šè®­ç»ƒé€šç”¨çš„ç¼–ç å™¨ï¼Œåªèƒ½å°†è¾“å…¥ token è½¬æ¢ä¸º embeddingï¼Œè¦å®ç°ä¸‹æ¸¸ä»»åŠ¡ï¼Œéœ€è¦æ¥å¯¹åº”çš„è§£ç å™¨ã€‚  \né˜¶æ®µäºŒï¼šæ²¡é‚£ä¹ˆå¥½ç”¨çš„æ¨¡å‹ï¼Œåªèƒ½ç”Ÿæˆ tokenï¼Œéœ€è¦åœ¨ç‰¹å®šä»»åŠ¡ä¸Šå¾®è°ƒï¼ˆç›¸åŒæ¶æ„ï¼Œä¸åŒçš„å‚æ•°ï¼‰  \né˜¶æ®µä¸‰ï¼šå¤§æ¨¡å‹æ—¶ä»£ï¼ä¸€ä¸ªæ¨¡å‹å¯ä»¥è§£å†³æ‰€æœ‰çš„é—®é¢˜ï¼ˆç›¸åŒæ¶æ„ï¼Œç›¸åŒå‚æ•°ï¼‰  \n\n\n\nå¦‚ä½•èµ‹äºˆæ¨¡å‹æ–°çš„èƒ½åŠ›ï¼Ÿ\næ–¹æ³•1ï¼šå¾®è°ƒ\n\næ–¹æ³•2ï¼šæ¨¡å‹ç¼–è¾‘\n\næ–¹æ³•3ï¼šæ¨¡å‹åˆå¹¶\n\n\n","categories":["ML2025"],"tags":["ML"]},{"title":"Pycharm debug æ–¹æ³•è®°å½•","url":"/blog/Mark/debug/","content":"Pycharm è°ƒè¯•æŒ‰é’®\nå‚è€ƒé“¾æ¥\n\n\nstep overï¼ˆF8å¿«æ·é”®ï¼‰ï¼šåœ¨å•æ­¥æ‰§è¡Œæ—¶ï¼Œåœ¨å‡½æ•°å†…é‡åˆ°å­å‡½æ•°æ—¶ä¸ä¼šè¿›å…¥å­å‡½æ•°å†…å•æ­¥æ‰§è¡Œï¼Œè€Œæ˜¯å°†å­å‡½æ•°æ•´ä¸ªæ‰§è¡Œå®Œå†åœæ­¢ï¼Œä¹Ÿå°±æ˜¯æŠŠå­å‡½æ•°æ•´ä¸ªä½œä¸ºä¸€æ­¥ã€‚åœ¨ä¸å­˜åœ¨å­å‡½æ•°çš„æƒ…å†µä¸‹æ˜¯å’Œstep intoæ•ˆæœä¸€æ ·çš„ã€‚\nstep intoï¼ˆF7å¿«æ·é”®ï¼‰ï¼šåœ¨å•æ­¥æ‰§è¡Œæ—¶ï¼Œé‡åˆ°å­å‡½æ•°å°±è¿›å…¥å¹¶ä¸”ç»§ç»­å•æ­¥æ‰§è¡Œï¼Œæœ‰çš„ä¼šè·³åˆ°æºä»£ç é‡Œé¢å»æ‰§è¡Œã€‚\nstep into my codeï¼ˆAlt+Shift+F7å¿«æ·é”®ï¼‰ï¼šåœ¨å•æ­¥æ‰§è¡Œæ—¶ï¼Œé‡åˆ°å­å‡½æ•°å°±è¿›å…¥å¹¶ä¸”ç»§ç»­å•æ­¥æ‰§è¡Œï¼Œä¸ä¼šè¿›å…¥åˆ°æºç ä¸­ã€‚\nstep outï¼ˆShift+F8å¿«æ·é”®ï¼‰ï¼šå‡å¦‚è¿›å…¥äº†ä¸€ä¸ªå‡½æ•°ä½“ä¸­ï¼Œçœ‹äº†ä¸¤è¡Œä»£ç ï¼Œä¸æƒ³çœ‹äº†ï¼Œè·³å‡ºå½“å‰å‡½æ•°ä½“å†…ï¼Œè¿”å›åˆ°è°ƒç”¨æ­¤å‡½æ•°çš„åœ°æ–¹ã€‚\nResume program (F9å¿«æ·é”®)ï¼šæ¢å¤ç¨‹åºï¼Œç›´æ¥è¿è¡Œåˆ°ä¸‹ä¸€æ–­ç‚¹å¤„ã€‚è‹¥æ— ä¸‹ä¸€æ–­ç‚¹ï¼Œåˆ™ç›´æ¥è·‘å®Œç¨‹åºã€‚\n\nè°ƒè¯•æ—¶å¸¦å‚æ•°\nå‚è€ƒé“¾æ¥\n\n\nrun -&gt; edit configurations\næ–°å»ºé€‰æ‹© pythonï¼Œname éšä¾¿å†™ï¼Œscript é€‰æ‹©è¦ debug çš„æ–‡ä»¶ï¼Œä¸‹æ–¹å¡«è¦æ·»åŠ çš„å‚æ•°ï¼Œæœ€ä¸‹æ–¹é€‰æ‹© â€œdebugâ€ ç‚¹å‡»å³å¯\n\n\n\n\n","categories":["ç‹ ç‹ markä½"],"tags":["Python","Pytorch"]},{"title":"git timeout æŠ¥é”™443è§£å†³æ–¹æ³•","url":"/blog/Mark/git-443/","content":"\nå‚è€ƒé“¾æ¥\n\nè§£å†³æ–¹æ³•\næŸ¥çœ‹ä»£ç†çš„ç«¯å£å·ï¼ˆclash çš„ General èœå•ä¸­ï¼Œé»˜è®¤ä¸º7890ï¼‰\næŸ¥çœ‹å¹¶å–æ¶ˆ git çš„ http å’Œ https ä»£ç†// é¦–å…ˆï¼ŒæŸ¥ä¸€ä¸‹å½“å‰å…¨å±€çš„ http ä»£ç†ï¼šgit config --global http.proxy// å¦‚æœæœ‰ä»£ç†ï¼Œå°±å–æ¶ˆgit config --global --unset http.proxy // å†æŸ¥ https çš„ä»£ç†ï¼šgit config --global https.proxy// åŒæ ·çš„ï¼Œæœ‰å°±å–æ¶ˆgit config --global --unset https.proxy\nè®¾ç½®ä»£ç†//è®¾ç½®gitç«¯å£å·å’Œä¸Šé¢çš„ç«¯å£å·ä¿æŒä¸€è‡´git config --global http.proxy http://127.0.0.1:7890git config --global https.proxy https://127.0.0.1:7890\n\n","categories":["ç‹ ç‹ markä½"],"tags":["Git"]},{"title":"hexoåŸºæœ¬å‘½ä»¤","url":"/blog/Mark/hexo-command/","content":"å¿«é€Ÿå¼€å§‹åˆ›å»ºæ–°åšå®¢$ hexo new &quot;My New Post&quot;\n\n\nè¿è¡ŒæœåŠ¡å™¨$ hexo server\nåŠ¨æ€éƒ¨ç½²ï¼Œä¿®æ”¹ä»£ç å®æ—¶æ›´æ–°ã€‚\nç”Ÿæˆé™æ€æ–‡ä»¶$ hexo generate\n\nè¿œç«¯éƒ¨ç½²$ hexo deploy\n\n\næ¸…ç†ç¼“å­˜$ hexo clean\nDonâ€™t forget to clean cacheâ€¦\næ ‡ç­¾æ’ä»¶é“¾æ¥åˆ°å…¶ä»–åšå®¢é¡µé¢ä½¿ç”¨ post_link æ ‡ç­¾ã€‚æ³¨æ„è¦ä»¥ &#x2F;_posts æ–‡ä»¶å¤¹ä¸ºæ ¹è·¯å¾„ã€‚å³ä½¿ä¸¤ä¸ª post åœ¨åŒä¸€ä¸ªå­æ–‡ä»¶ä¸‹ï¼Œä¹Ÿéœ€è¦å†™å‡ºå­æ–‡ä»¶å¤¹çš„åå­—ï¼Œä¾‹å¦‚ä¸‹é¢çš„ hello-world é¡µé¢ä½äº _post æ–‡ä»¶å¤¹ä¸‹ï¼Œå°±ç›´æ¥å†™æ–‡ä»¶åã€‚\n&#123;% post_link ç›¸å¯¹è·¯å¾„ &#x27;é“¾æ¥æ–‡å­—&#x27; %&#125;&lt;!-- &#123;% post_link hello-world &#x27;è®¿é—®é¦–é¡µ&#x27; %&#125; --&gt;\nè®¿é—®é¦–é¡µ\n\nå¼•ç”¨å—&#123;% blockquote [author[, source]] [link] [source_link_title] %&#125;content&#123;% endblockquote %&#125;\nexample\nhexo-officialä»£ç å—\n\nä»£ç å—&#123;% codeblock %&#125;alert(&#x27;Hello World!&#x27;);&#123;% endcodeblock %&#125;\nç­‰åŒäºä½¿ç”¨åå¼•å· \n``` your code ``` \n\n\nHexoæ–°å»ºæ–‡ç« åˆ°å­ç›®å½•hexo new å‘½ä»¤è¯´æ˜ï¼š\nUsage: hexo new [layout] &lt;title&gt;Description:Create a new post.Arguments:  layout  Post layout. Use post, page, draft or whatever you want.  title   Post title. Wrap it with quotations to escape.Options:  -p, --path     Post path. Customize the path of the post.  -r, --replace  Replace the current post if existed.  -s, --slug     Post slug. Customize the URL of the post.\nä¾‹å¦‚ï¼Œåœ¨ 202411/ æ–‡ä»¶å¤¹ä¸‹æ–°å»º test.md æ–‡ä»¶\nhexo n -p 202411/test.md\n\n","categories":["ç‹ ç‹ markä½"],"tags":["Hexo"]},{"title":"Huggingface ç›¸å…³é—®é¢˜","url":"/blog/Mark/hf/","content":"æ›´æ¢ Huggingface æº\nexport HF_ENDPOINT&#x3D;https://hf-mirror.com\n\nä¸€é”®ä¸‹è½½ Huggingface æ¨¡å‹ä¸‹è½½ huggingface-cli ã€‚\n\nhuggingface-cli download model_name â€“local-dir .&#x2F;your_download_dir\n\nåªéœ€è¦æ›´æ”¹ model_name å’Œ ./your_download_dir ã€‚\n","categories":["ç‹ ç‹ markä½"],"tags":["LLM"]},{"title":"Numpy æŠ¥é”™ï¼šnumpy is not available","url":"/blog/Mark/numpy/","content":"æè¿°æŠ¥é”™å¦‚ä¸‹ï¼š\n\nA module is compiled with numpy 1.X cannot be run in numpy 2.X\n\nè§£å†³æ–¹æ³•æ¢æ—§ç‰ˆæœ¬çš„ numpy\npip uninstall numpypip install numpy==1.25.3\n","categories":["ç‹ ç‹ markä½"],"tags":["Python","Pytorch"]},{"title":"Ubuntu å†…æ ¸ä¸ Nvidia é©±åŠ¨ä¸åŒ¹é…é—®é¢˜","url":"/blog/Mark/nvidia-kernal/","content":"\nä¸€å®šè¦å…³ç³»è‡ªåŠ¨æ›´æ–°ï¼ï¼\nå¸è½½å¹¶å®‰è£…é©±åŠ¨\nhttps://www.cnblogs.com/aliving/articles/18389099\n\n\næ›´æ”¹å†…æ ¸ç‰ˆæœ¬\nhttps://blog.csdn.net/damifeng/article/details/132985518\n\næŸ¥çœ‹å¯ä»¥å®‰è£…çš„å†…æ ¸ç‰ˆæœ¬ï¼ˆæœºå­ä¸Šæ›¾ç»ä¸‹è¿‡çš„ï¼Œä¸ä¼šåˆ é™¤ï¼‰\n\ndpkg â€“get-selections|grep linux\n\n\nä¸‹è½½æŒ‡å®šç‰ˆæœ¬\n  sudo apt-get install linux-image-xxx-genericsudo apt-get install linux-headers-xxx-genericsudo apt-get install linux-modules-xxx-genericsudo apt-get install linux-modules-extra-xxx-genericsudo apt-get install linux-tools-xxx-generic\næ›´æ–° initramfs\n\nsudo update-initramfs -u -k all\n\n\nä¿®æ”¹ grubï¼Œé€‰æ‹©æŒ‡å®šå†…æ ¸\n\nhttps://www.8kiz.cn/archives/14385.html\nå¼€æœºç‹‚æŒ‰ shiftï¼Œé€‰æ‹© advanced options\n\n\nä¸€å®šè¦\n  sudo update-grub\n\n\nåˆ é™¤ä¸‹è½½çš„å†…æ ¸ï¼ˆä¸æ˜¯çœŸçš„åˆ é™¤ï¼‰\nhttps://download.csdn.net/blog/column/12270246/130411204\n\n\n\n","categories":["ç‹ ç‹ markä½"],"tags":["Linux"]},{"title":"ã€ä»£ç éšæƒ³å½•ã€‘æ•°ç»„2-åŒæŒ‡é’ˆæ³•","url":"/blog/Leetcode/array2/","content":"27. ç§»é™¤å…ƒç´ \né¢˜ç›®é“¾æ¥ link\n\nç»™ä½ ä¸€ä¸ªæ•°ç»„ nums å’Œä¸€ä¸ªå€¼ valï¼Œä½ éœ€è¦ åŸåœ° ç§»é™¤æ‰€æœ‰æ•°å€¼ç­‰äº val çš„å…ƒç´ ï¼Œå¹¶è¿”å›ç§»é™¤åæ•°ç»„çš„æ–°é•¿åº¦ã€‚\nä¸è¦ä½¿ç”¨é¢å¤–çš„æ•°ç»„ç©ºé—´ï¼Œä½ å¿…é¡»ä»…ä½¿ç”¨ O(1) é¢å¤–ç©ºé—´å¹¶åŸåœ°ä¿®æ”¹è¾“å…¥æ•°ç»„ã€‚\nå…ƒç´ çš„é¡ºåºå¯ä»¥æ”¹å˜ã€‚ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚\nç¤ºä¾‹ 1: \n\nç»™å®š nums &#x3D; [3,2,2,3], val &#x3D; 3, å‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 2, å¹¶ä¸” nums ä¸­çš„å‰ä¸¤ä¸ªå…ƒç´ å‡ä¸º 2ã€‚ ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚\n\nç¤ºä¾‹ 2: \n\nç»™å®š nums &#x3D; [0,1,2,2,3,0,4,2], val &#x3D; 2, å‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 5, å¹¶ä¸” nums ä¸­çš„å‰äº”ä¸ªå…ƒç´ ä¸º 0, 1, 3, 0, 4ã€‚\n\nä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚\næ³¨æ„ï¼šéœ€è¦æ”¹åŠ¨åŸæ¥çš„æ•°ç»„ï¼Œè™½ç„¶æ²¡æœ‰ç›´æ¥è¿”å›æ”¹åŠ¨åçš„æ•°ç»„\næš´åŠ›è§£æ³•ä¸¤ä¸ªå¾ªç¯ï¼Œåˆ†åˆ«ç”¨äºæŸ¥æ‰¾ val å’Œç§»åŠ¨åç»­å…ƒç´ ã€‚æ³¨æ„ç¬¬ä¸€ä¸ªå¾ªç¯è¦ç”¨ whileï¼Œå› ä¸ºç§»åŠ¨åç»­å…ƒç´ æ—¶å‡å°‘äº†ä¸€ä½ï¼Œfor å¾ªç¯æ— æ³•æ§åˆ¶å˜é‡ iã€‚\nclass Solution:    def removeElement(self, nums: List[int], val: int) -&gt; int:        size = len(nums)        i = 0        while i &lt; size:            if nums[i] == val:                for j in range(i+1, size):                    nums[j-1] = nums[j]                size -= 1                i -= 1            i += 1        return size\n\nåŒæŒ‡é’ˆæ³•åŒæŒ‡é’ˆæ³•ï¼ˆå¿«æ…¢æŒ‡é’ˆæ³•ï¼‰ï¼š é€šè¿‡ä¸€ä¸ªå¿«æŒ‡é’ˆå’Œæ…¢æŒ‡é’ˆåœ¨ä¸€ä¸ªforå¾ªç¯ä¸‹å®Œæˆä¸¤ä¸ªforå¾ªç¯çš„å·¥ä½œã€‚æœ¬é¢˜ä¸­ï¼Œä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«ä»£è¡¨ï¼š\n\nå¿«æŒ‡é’ˆï¼šæŸ¥æ‰¾çš„ç´¢å¼•\næ…¢æŒ‡é’ˆï¼šæ›´æ”¹åçš„æ•°ç»„çš„ç´¢å¼•æ­¤å¤–ï¼Œæ¯ä¸€æ­¥éƒ½éœ€è¦æŠŠå¿«æŒ‡é’ˆçš„å€¼èµ‹å€¼ç»™æ…¢æŒ‡é’ˆï¼ˆæ— è®ºæ˜¯å¦é‡åˆ°ç­‰äºï¼‰class Solution:    def removeElement(self, nums: List[int], val: int) -&gt; int:        size = len(nums)        fast, slow = 0, 0        while fast &lt; size:            nums[slow] = nums[fast]            if nums[fast] == val:                slow -= 1            fast += 1            slow += 1                return slow\n\n26. åˆ é™¤æœ‰åºæ•°ç»„ä¸­çš„é‡å¤é¡¹\né¢˜ç›®é“¾æ¥ link\n\nç»™ä½ ä¸€ä¸ª éä¸¥æ ¼é€’å¢æ’åˆ— çš„æ•°ç»„ nums ï¼Œè¯·ä½  åŸåœ° åˆ é™¤é‡å¤å‡ºç°çš„å…ƒç´ ï¼Œä½¿æ¯ä¸ªå…ƒç´  åªå‡ºç°ä¸€æ¬¡ ï¼Œè¿”å›åˆ é™¤åæ•°ç»„çš„æ–°é•¿åº¦ã€‚å…ƒç´ çš„ ç›¸å¯¹é¡ºåº åº”è¯¥ä¿æŒ ä¸€è‡´ ã€‚ç„¶åè¿”å› nums ä¸­å”¯ä¸€å…ƒç´ çš„ä¸ªæ•°ã€‚\nè€ƒè™‘ nums çš„å”¯ä¸€å…ƒç´ çš„æ•°é‡ä¸º k ï¼Œä½ éœ€è¦åšä»¥ä¸‹äº‹æƒ…ç¡®ä¿ä½ çš„é¢˜è§£å¯ä»¥è¢«é€šè¿‡ï¼š\næ›´æ”¹æ•°ç»„ nums ï¼Œä½¿ nums çš„å‰ k ä¸ªå…ƒç´ åŒ…å«å”¯ä¸€å…ƒç´ ï¼Œå¹¶æŒ‰ç…§å®ƒä»¬æœ€åˆåœ¨ nums ä¸­å‡ºç°çš„é¡ºåºæ’åˆ—ã€‚nums çš„å…¶ä½™å…ƒç´ ä¸ nums çš„å¤§å°ä¸é‡è¦ã€‚è¿”å› k ã€‚\nç¤ºä¾‹ 1ï¼š\n\nè¾“å…¥ï¼šnums &#x3D; [1,1,2]è¾“å‡ºï¼š2, nums &#x3D; [1,2,_]è§£é‡Šï¼šå‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 2 ï¼Œå¹¶ä¸”åŸæ•°ç»„ nums çš„å‰ä¸¤ä¸ªå…ƒç´ è¢«ä¿®æ”¹ä¸º 1, 2 ã€‚ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚\n\nç¤ºä¾‹ 2ï¼š\n\nè¾“å…¥ï¼šnums &#x3D; [0,0,1,1,1,2,2,3,3,4]è¾“å‡ºï¼š5, nums &#x3D; [0,1,2,3,4]è§£é‡Šï¼šå‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 5 ï¼Œ å¹¶ä¸”åŸæ•°ç»„ nums çš„å‰äº”ä¸ªå…ƒç´ è¢«ä¿®æ”¹ä¸º 0, 1, 2, 3, 4 ã€‚ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚\n\næ€è·¯ä»ç„¶æ˜¯å¿«æ…¢æŒ‡é’ˆæ³•ï¼Œåªæ˜¯æ²¡æœ‰ç»™å®š valï¼Œéœ€è¦åœ¨å¾ªç¯ä¸­åŠ¨æ€æ›´æ–° valã€‚æ›´æ–° val çš„è§„åˆ™ä¸ºï¼Œå¦‚æœå½“å‰ fast å¯¹åº”çš„å€¼ä¸ç­‰äº valï¼Œåˆ™å°†å…¶èµ‹å€¼ç»™ valã€‚å› ä¸ºæ•°ç»„å‡åºæ’åˆ—ï¼Œç›¸åŒçš„æ•°å­—åœ¨ä¸€èµ·ï¼Œå¦‚æœ fast å¯¹åº”çš„å€¼å’Œ valï¼ˆä¸Šä¸€ä¸ªæ•°å­—ï¼‰ä¸ç›¸ç­‰ï¼Œè¯´æ˜ä¸Šä¸€ä¸ªæ•°å­—å·²ç»ä¸é‡å¤äº†ã€‚\nclass Solution:    def removeDuplicates(self, nums: List[int]) -&gt; int:        slow, fast = 0, 0        size = len(nums)        val = None               while fast &lt; size:            nums[slow] = nums[fast]            if val == nums[fast]:                slow -= 1            else:                val = nums[fast]            slow += 1            fast += 1        return slow\n283. ç§»åŠ¨é›¶\né¢˜ç›®é“¾æ¥ link\n\nç»™å®šä¸€ä¸ªæ•°ç»„ numsï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°å°†æ‰€æœ‰ 0 ç§»åŠ¨åˆ°æ•°ç»„çš„æœ«å°¾ï¼ŒåŒæ—¶ä¿æŒéé›¶å…ƒç´ çš„ç›¸å¯¹é¡ºåºã€‚\nè¯·æ³¨æ„ ï¼Œå¿…é¡»åœ¨ä¸å¤åˆ¶æ•°ç»„çš„æƒ…å†µä¸‹åŸåœ°å¯¹æ•°ç»„è¿›è¡Œæ“ä½œã€‚\nç¤ºä¾‹ 1:\n\nè¾“å…¥: nums &#x3D; [0,1,0,3,12]è¾“å‡º: [1,3,12,0,0]\n\nç¤ºä¾‹ 2:\n\nè¾“å…¥: nums &#x3D; [0]è¾“å‡º: [0]\n\næ€è·¯ç›¸å½“äºæ˜¯ val ä¸º 0 çš„åˆ é™¤å…ƒç´ ï¼ŒåŒæ ·ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆæ³•ï¼Œåªæ˜¯æœ€åéœ€è¦å°† [slow, fast) åŒºé—´å†…çš„å…ƒç´ èµ‹å€¼ä¸º 0ã€‚\nclass Solution:    def moveZeroes(self, nums: List[int]) -&gt; None:        &quot;&quot;&quot;        Do not return anything, modify nums in-place instead.        &quot;&quot;&quot;        slow, fast, size = 0, 0, len(nums)        while fast &lt; size:            nums[slow] = nums[fast]            if nums[fast] == 0:                slow -= 1            slow += 1            fast += 1                if fast != slow:            for i in range(slow, fast):                nums[i] = 0\n844. æ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²\né¢˜ç›®é“¾æ¥ link\n\nç»™å®š s å’Œ t ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå½“å®ƒä»¬åˆ†åˆ«è¢«è¾“å…¥åˆ°ç©ºç™½çš„æ–‡æœ¬ç¼–è¾‘å™¨åï¼Œå¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› true ã€‚# ä»£è¡¨é€€æ ¼å­—ç¬¦ã€‚\næ³¨æ„ï¼šå¦‚æœå¯¹ç©ºæ–‡æœ¬è¾“å…¥é€€æ ¼å­—ç¬¦ï¼Œæ–‡æœ¬ç»§ç»­ä¸ºç©ºã€‚\nç¤ºä¾‹ 1ï¼š\n\nè¾“å…¥ï¼šs &#x3D; â€œab#câ€, t &#x3D; â€œad#câ€è¾“å‡ºï¼štrueè§£é‡Šï¼šs å’Œ t éƒ½ä¼šå˜æˆ â€œacâ€ã€‚\n\nç¤ºä¾‹ 2ï¼š\n\nè¾“å…¥ï¼šs &#x3D; â€œab##â€, t &#x3D; â€œc#d#â€è¾“å‡ºï¼štrueè§£é‡Šï¼šs å’Œ t éƒ½ä¼šå˜æˆ â€œâ€ã€‚\n\nç¤ºä¾‹ 3ï¼š\n\nè¾“å…¥ï¼šs &#x3D; â€œa#câ€, t &#x3D; â€œbâ€è¾“å‡ºï¼šfalseè§£é‡Šï¼šs ä¼šå˜æˆ â€œcâ€ï¼Œä½† t ä»ç„¶æ˜¯ â€œbâ€ã€‚\n\næ€è·¯1åŒæŒ‡é’ˆæ³•ï¼Œç›¸å½“äºæ˜¯æŸ¥æ‰¾ â€œ#â€ å­—ç¬¦ï¼ŒæŸ¥æ‰¾åˆ°ä¹‹ååˆ é™¤ # ä»¥åŠå…¶ä¹‹å‰çš„å­—ç¬¦ã€‚æ³¨æ„è¦è€ƒè™‘ # ä¹‹å‰æ²¡æœ‰å­—ç¬¦çš„æƒ…å†µã€‚\nclass Solution:    def backspaceCompare(self, s: str, t: str) -&gt; bool:        def dele(nums: list):            slow, fast, size = 0, 0, len(nums)            while fast &lt; size:                nums[slow] = nums[fast]                if nums[fast] == &quot;#&quot;:                    if slow == 0:                        slow -= 1                    else:                        slow -= 2                                slow += 1                fast += 1            if slow &lt; 0:                return []            else:                return nums[0: slow]                s1 = dele(list(s))        t1 = dele(list(t))        s = &quot;&quot;.join(s1)        t = &quot;&quot;.join(t1)        if s == t:            return True        else:            return False\n\næ€è·¯2ä½¿ç”¨æ ˆçš„æ€æƒ³ï¼Œéå†åˆ° # å­—ç¬¦ï¼Œåˆ™å½“å‰æ ˆé¡¶çš„å­—ç¬¦ popã€‚æ³¨æ„ list çš„ pop æ–¹æ³•éœ€è¦ list ä¸ä¸ºç©ºï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œåˆ¤æ–­ã€‚\nclass Solution:    def backspaceCompare(self, s: str, t: str) -&gt; bool:        def dele(nums: list):            ret = list()            for i in nums:                                if i != &quot;#&quot;:                                        ret.append(i)                elif len(ret) != 0:                    ret.pop()                        return &quot;&quot;.join(ret)        s = dele(list(s))        t = dele(list(t))                if s == t:            return True        else:            return False\n\n977. æœ‰åºæ•°ç»„çš„å¹³æ–¹\né¢˜ç›®é“¾æ¥ linkç»™ä½ ä¸€ä¸ªæŒ‰ éé€’å‡é¡ºåº æ’åºçš„æ•´æ•°æ•°ç»„ numsï¼Œè¿”å› æ¯ä¸ªæ•°å­—çš„å¹³æ–¹ ç»„æˆçš„æ–°æ•°ç»„ï¼Œè¦æ±‚ä¹ŸæŒ‰ éé€’å‡é¡ºåº æ’åºã€‚\n\nç¤ºä¾‹ 1ï¼š\n\nè¾“å…¥ï¼šnums &#x3D; [-4,-1,0,3,10]è¾“å‡ºï¼š[0,1,9,16,100]è§£é‡Šï¼šå¹³æ–¹åï¼Œæ•°ç»„å˜ä¸º [16,1,0,9,100]æ’åºåï¼Œæ•°ç»„å˜ä¸º [0,1,9,16,100]\n\nç¤ºä¾‹ 2ï¼š\n\nè¾“å…¥ï¼šnums &#x3D; [-7,-3,2,3,11]è¾“å‡ºï¼š[4,9,9,49,121]\n\næ€è·¯åŒæŒ‡é’ˆæ³•ï¼Œå·¦å³åˆ†åˆ«ä¸¤ä¸ªæŒ‡é’ˆï¼Œä¾æ¬¡æ¯”è¾ƒå¤§å°ï¼Œç›´åˆ°å·¦æŒ‡é’ˆå¤§äºå³æŒ‡é’ˆã€‚æ³¨æ„ï¼Œè¿™é‡Œéœ€è¦è¿”å›æ–°çš„æ•°ç»„ï¼Œå’Œä¸Šé¢çš„é¢˜ç›®ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å¯ä»¥æ–°å»ºæ•°ç»„ï¼Œä¸éœ€è¦åœ¨åŸæœ‰æ•°ç»„ä¸Šæ“ä½œã€‚\nclass Solution:    def sortedSquares(self, nums: List[int]) -&gt; List[int]:        left, right = 0, len(nums) - 1        new_nums = [0] * len(nums)        i = len(nums) - 1        while left &lt;= right:            if nums[left] * nums[left] &lt; nums[right] * nums[right]:                new_nums[i] = nums[right] * nums[right]                right -= 1            else:                new_nums[i] = nums[left] * nums[left]                left += 1            i -= 1        return new_nums        \n","categories":["Leetcode"],"tags":["Array"]}]